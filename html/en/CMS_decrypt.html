<html>
<head><meta charset=utf-8/>
<title>CMS_decrypt - decrypt content from a CMS envelopedData structure</title></head>
<body><pre>

CMS_decrypt(3SSL)                    OpenSSL                   CMS_decrypt(3SSL)



NAME
        CMS_decrypt - decrypt content from a CMS envelopedData structure

SYNOPSIS
        #include &lt;openssl/cms.h&gt;

        int CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pkey, X509 *cert, BIO *dcont, BIO *out, unsigned int flags);

DESCRIPTION
       CMS_decrypt() extracts and decrypts the content from a CMS EnvelopedData
       structure. pkey is the private key of the recipient, cert is the
       recipient&apos;s certificate, out is a BIO to write the content to and flags
       is an optional set of flags.

       The dcont parameter is used in the rare case where the encrypted content
       is detached. It will normally be set to NULL.

NOTES
       OpenSSL_add_all_algorithms() (or equivalent) should be called before
       using this function or errors about unknown algorithms will occur.

       Although the recipients certificate is not needed to decrypt the data it
       is needed to locate the appropriate (of possible several) recipients in
       the CMS structure. If cert is set to NULL all possible recipients are
       tried.

       It is possible to determine the correct recipient key by other means (for
       example looking them up in a database) and setting them in the CMS
       structure in advance using the CMS utility functions such as
       CMS_set1_pkey(). In this case both cert and pkey should be set to NULL.

       To process KEKRecipientInfo types CMS_set1_key() or
       CMS_RecipientInfo_set0_key() and CMS_ReceipientInfo_decrypt() should be
       called before CMS_decrypt() and cert and pkey set to NULL.

       The following flags can be passed in the flags parameter.

       If the CMS_TEXT flag is set MIME headers for type text/plain are deleted
       from the content. If the content is not of type text/plain then an error
       is returned.

RETURN VALUES
       CMS_decrypt() returns either 1 for success or 0 for failure.  The error
       can be obtained from ERR_get_error(3)

BUGS
       The lack of single pass processing and the need to hold all data in
       memory as mentioned in CMS_verify() also applies to CMS_decrypt().

SEE ALSO
       ERR_get_error(3), CMS_encrypt(3)

HISTORY
       CMS_decrypt() was added to OpenSSL 0.9.8



1.0.1e                             2013-02-11                  CMS_decrypt(3SSL)

</pre></body></html>
