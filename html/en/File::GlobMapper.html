<html>
<head><meta charset=utf-8/>
<title>File::GlobMapper - Extend File Glob to Allow Input and Output Files</title></head>
<body><pre>

File::GlobMapper(3pm)  User Contributed Perl Documentation File::GlobMapper(3pm)



NAME
       File::GlobMapper - Extend File Glob to Allow Input and Output Files

SYNOPSIS
           use File::GlobMapper qw( globmap );

           my $aref = globmap $input =&gt; $output
               or die $File::GlobMapper::Error ;

           my $gm = new File::GlobMapper $input =&gt; $output
               or die $File::GlobMapper::Error ;

DESCRIPTION
       This module needs Perl5.005 or better.

       This module takes the existing &quot;File::Glob&quot; module as a starting point
       and extends it to allow new filenames to be derived from the files
       matched by &quot;File::Glob&quot;.

       This can be useful when carrying out batch operations on multiple files
       that have both an input filename and output filename and the output file
       can be derived from the input filename. Examples of operations where this
       can be useful include, file renaming, file copying and file compression.

   Behind The Scenes
       To help explain what &quot;File::GlobMapper&quot; does, consider what code you
       would write if you wanted to rename all files in the current directory
       that ended in &quot;.tar.gz&quot; to &quot;.tgz&quot;. So say these files are in the current
       directory

           alpha.tar.gz
           beta.tar.gz
           gamma.tar.gz

       and they need renamed to this

           alpha.tgz
           beta.tgz
           gamma.tgz

       Below is a possible implementation of a script to carry out the rename
       (error cases have been omitted)

           foreach my $old ( glob &quot;*.tar.gz&quot; )
           {
               my $new = $old;
               $new =~ s#(.*)\.tar\.gz$#$1.tgz# ;

               rename $old =&gt; $new
                   or die &quot;Cannot rename &apos;$old&apos; to &apos;$new&apos;: $!\n;
           }

       Notice that a file glob pattern &quot;*.tar.gz&quot; was used to match the
       &quot;.tar.gz&quot; files, then a fairly similar regular expression was used in the
       substitute to allow the new filename to be created.

       Given that the file glob is just a cut-down regular expression and that
       it has already done a lot of the hard work in pattern matching the
       filenames, wouldn&apos;t it be handy to be able to use the patterns in the
       fileglob to drive the new filename?

       Well, that&apos;s exactly what &quot;File::GlobMapper&quot; does.

       Here is same snippet of code rewritten using &quot;globmap&quot;

           for my $pair (globmap &apos;&lt;*.tar.gz&gt;&apos; =&gt; &apos;&lt;#1.tgz&gt;&apos; )
           {
               my ($from, $to) = @$pair;
               rename $from =&gt; $to
                   or die &quot;Cannot rename &apos;$old&apos; to &apos;$new&apos;: $!\n;
           }

       So how does it work?

       Behind the scenes the &quot;globmap&quot; function does a combination of a file
       glob to match existing filenames followed by a substitute to create the
       new filenames.

       Notice how both parameters to &quot;globmap&quot; are strings that are delimited by
       &lt;&gt;.  This is done to make them look more like file globs - it is just
       syntactic sugar, but it can be handy when you want the strings to be
       visually distinctive. The enclosing &lt;&gt; are optional, so you don&apos;t have to
       use them - in fact the first thing globmap will do is remove these
       delimiters if they are present.

       The first parameter to &quot;globmap&quot;, &quot;*.tar.gz&quot;, is an Input File Glob.
       Once the enclosing &quot;&lt; ... &gt;&quot; is removed, this is passed (more or less)
       unchanged to &quot;File::Glob&quot; to carry out a file match.

       Next the fileglob &quot;*.tar.gz&quot; is transformed behind the scenes into a full
       Perl regular expression, with the additional step of wrapping each
       transformed wildcard metacharacter sequence in parenthesis.

       In this case the input fileglob &quot;*.tar.gz&quot; will be transformed into this
       Perl regular expression

           ([^/]*)\.tar\.gz

       Wrapping with parenthesis allows the wildcard parts of the Input File
       Glob to be referenced by the second parameter to &quot;globmap&quot;, &quot;#1.tgz&quot;, the
       Output File Glob. This parameter operates just like the replacement part
       of a substitute command. The difference is that the &quot;#1&quot; syntax is used
       to reference sub-patterns matched in the input fileglob, rather than the
       $1 syntax that is used with perl regular expressions. In this case &quot;#1&quot;
       is used to refer to the text matched by the &quot;*&quot; in the Input File Glob.
       This makes it easier to use this module where the parameters to &quot;globmap&quot;
       are typed at the command line.

       The final step involves passing each filename matched by the &quot;*.tar.gz&quot;
       file glob through the derived Perl regular expression in turn and
       expanding the output fileglob using it.

       The end result of all this is a list of pairs of filenames. By default
       that is what is returned by &quot;globmap&quot;. In this example the data structure
       returned will look like this

            ( [&apos;alpha.tar.gz&apos; =&gt; &apos;alpha.tgz&apos;],
              [&apos;beta.tar.gz&apos;  =&gt; &apos;beta.tgz&apos; ],
              [&apos;gamma.tar.gz&apos; =&gt; &apos;gamma.tgz&apos;]
            )

       Each pair is an array reference with two elements - namely the from
       filename, that &quot;File::Glob&quot; has matched, and a to filename that is
       derived from the from filename.

   Limitations
       &quot;File::GlobMapper&quot; has been kept simple deliberately, so it isn&apos;t
       intended to solve all filename mapping operations. Under the hood
       &quot;File::Glob&quot; (or for older versions of Perl, &quot;File::BSDGlob&quot;) is used to
       match the files, so you will never have the flexibility of full Perl
       regular expression.

   Input File Glob
       The syntax for an Input FileGlob is identical to &quot;File::Glob&quot;, except for
       the following

       1.   No nested {}

       2.   Whitespace does not delimit fileglobs.

       3.   The use of parenthesis can be used to capture parts of the input
            filename.

       4.   If an Input glob matches the same file more than once, only the
            first will be used.

       The syntax

       ~
       ~user
       .    Matches a literal &apos;.&apos;.  Equivalent to the Perl regular expression

                \.

       *    Matches zero or more characters, except &apos;/&apos;. Equivalent to the Perl
            regular expression

                [^/]*

       ?    Matches zero or one character, except &apos;/&apos;. Equivalent to the Perl
            regular expression

                [^/]?

       \    Backslash is used, as usual, to escape the next character.

       []   Character class.

       {,}  Alternation

       ()   Capturing parenthesis that work just like perl

       Any other character it taken literally.

   Output File Glob
       The Output File Glob is a normal string, with 2 glob-like features.

       The first is the &apos;*&apos; metacharacter. This will be replaced by the complete
       filename matched by the input file glob. So

           *.c *.Z

       The second is

       Output FileGlobs take the

       &quot;*&quot;  The &quot;*&quot; character will be replaced with the complete input filename.

       #1   Patterns of the form /#\d/ will be replaced with the

   Returned Data
EXAMPLES
   A Rename script
       Below is a simple &quot;rename&quot; script that uses &quot;globmap&quot; to determine the
       source and destination filenames.

           use File::GlobMapper qw(globmap) ;
           use File::Copy;

           die &quot;rename: Usage rename &apos;from&apos; &apos;to&apos;\n&quot;
               unless @ARGV == 2 ;

           my $fromGlob = shift @ARGV;
           my $toGlob   = shift @ARGV;

           my $pairs = globmap($fromGlob, $toGlob)
               or die $File::GlobMapper::Error;

           for my $pair (@$pairs)
           {
               my ($from, $to) = @$pair;
               move $from =&gt; $to ;
           }

       Here is an example that renames all c files to cpp.

           $ rename &apos;*.c&apos; &apos;#1.cpp&apos;

   A few example globmaps
       Below are a few examples of globmaps

       To copy all your .c file to a backup directory

           &apos;&lt;/my/home/*.c&gt;&apos;    &apos;&lt;/my/backup/#1.c&gt;&apos;

       If you want to compress all

           &apos;&lt;/my/home/*.[ch]&gt;&apos;    &apos;&lt;*.gz&gt;&apos;

       To uncompress

           &apos;&lt;/my/home/*.[ch].gz&gt;&apos;    &apos;&lt;/my/home/#1.#2&gt;&apos;

SEE ALSO
       File::Glob

AUTHOR
       The File::GlobMapper module was written by Paul Marquess, pmqs@cpan.org.

COPYRIGHT AND LICENSE
       Copyright (c) 2005 Paul Marquess. All rights reserved.  This program is
       free software; you can redistribute it and/or modify it under the same
       terms as Perl itself.



perl v5.14.2                       2011-01-07              File::GlobMapper(3pm)

</pre></body></html>
