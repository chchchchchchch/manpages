<html>
<head><meta charset=utf-8/>
<title>Log::Log4perl::Catalyst - Log::Log4perl Catalyst Module</title></head>
<body><pre>

Catalyst(3pm)          User Contributed Perl Documentation         Catalyst(3pm)



NAME
       Log::Log4perl::Catalyst - Log::Log4perl Catalyst Module

SYNOPSIS
       In your main Catalyst application module:

         use Log::Log4perl::Catalyst;

           # Either make Log4perl act like the Catalyst default logger:
         __PACKAGE__-&gt;log(Log::Log4perl::Catalyst-&gt;new());

           # or use a Log4perl configuration file, utilizing the full
           # functionality of Log4perl
         __PACKAGE__-&gt;log(Log::Log4perl::Catalyst-&gt;new(&apos;l4p.conf&apos;));

       ... and then sprinkly logging statements all over any code executed by
       Catalyst:

           $c-&gt;log-&gt;debug(&quot;This is using log4perl!&quot;);

DESCRIPTION
       This module provides Log4perl functions to Catalyst applications. It was
       inspired by Catalyst::Log::Log4perl on CPAN, but has been completely
       rewritten and uses a different approach to unite Catalyst and Log4perl.

       Log4perl provides loggers, usually associated with the current package,
       which can then be remote-controlled by a central configuration. This
       means that if you have a controller function like

           package MyApp::Controller::User;

           sub add : Chained(&apos;base&apos;): PathPart(&apos;add&apos;): Args(0) {
               my ( $self, $c ) = @_;

               $c-&gt;log-&gt;info(&quot;Adding a user&quot;);
               # ...
           }

       Level-based control is available via the following methods:

          $c-&gt;log-&gt;debug(&quot;Reading configuration&quot;);
          $c-&gt;log-&gt;info(&quot;Adding a user&quot;);
          $c-&gt;log-&gt;warn(&quot;Can&apos;t read configuration ($!)&quot;);
          $c-&gt;log-&gt;error(&quot;Can&apos;t add user &quot;, $user);
          $c-&gt;log-&gt;fatal(&quot;Database down, aborting request&quot;);

       But that&apos;s no all, Log4perl is much more powerful.

       The logging statement can be suppressed or activated based on a Log4perl
       file that looks like

             # All MyApp loggers opened up for DEBUG and above
           log4perl.logger.MyApp = DEBUG, Screen
           # ...

       or

             # All loggers block messages below INFO
           log4perl.logger=INFO, Screen
           # ...

       respectively. See the Log4perl manpage on how to perform fine-grained
       log-level and location filtering, and how to forward messages not only to
       the screen or to log files, but also to databases, email appenders, and
       much more.

       Also, you can vary the layout of each message. For example if you want to
       know where a particular statement was logged, turn on file names and line
       numbers:

           # Log4perl configuration file
           # ...
           log4perl.appender.Screen.layout.ConversionPattern = \
                 %F{1}-%L: %p %m%n

       Messages will then look like

           MyApp.pm-1869: INFO Saving user profile for user &quot;wonko&quot;

       Or want to log a request&apos;s IP address with every log statement? No
       problem with Log4perl, just call

           Log::Log4perl::MDC-&gt;put( &quot;ip&quot;, $c-&gt;req-&gt;address() );

       at the beginning of the request cycle and use

           # Log4perl configuration file
           # ...
           log4perl.appender.Screen.layout.ConversionPattern = \
                 [%d]-%X{ip} %F{1}-%L: %p %m%n

       as a Log4perl layout. Messages will look like

           [2010/02/22 23:25:55]-123.122.108.10 MyApp.pm-1953: INFO Reading profile for user &quot;wonko&quot;

       Again, check the Log4perl manual page, there&apos;s a plethora of
       configuration options.

METHODS
       new($config, [%options])
           If called without parameters, new() initializes Log4perl in a way so
           that messages are logged similiarly to Catalyst&apos;s default logging
           mechanism. If you provide configuration, either the name of a
           configuration file or a reference to scalar string containing the
           configuration, it will call Log4perl with these parameters.

           The second (optional) parameter is a list of key/value pairs:

             &apos;autoflush&apos;   =&gt;  1   # Log without buffering (&apos;abort&apos; not supported)
             &apos;watch_delay&apos; =&gt; 30   # If set, use L&lt;Log::Log4perl&gt;&apos;s init_and_watch

       _flush()
           Flushes the cache.

       abort($abort)
           Clears the logging system&apos;s internal buffers without logging
           anything.

   Using :easy Macros with Catalyst
       If you&apos;re tired of typing

           $c-&gt;log-&gt;debug(&quot;...&quot;);

       and would prefer to use Log4perl&apos;s convenient :easy mode macros like

           DEBUG &quot;...&quot;;

       then just pull those macros in via Log::Log4perl&apos;s :easy mode and start
       cranking:

           use Log::Log4perl qw(:easy);

             # ... use macros later on
           sub base :Chained(&apos;/&apos;) :PathPart(&apos;apples&apos;) :CaptureArgs(0) {
               my ( $self, $c ) = @_;

               DEBUG &quot;Handling apples&quot;;
           }

       Note the difference between Log4perl&apos;s initialization in Catalyst, which
       uses the Catalyst-specific Log::Log4perl::Catalyst module (top of this
       page), and making use of Log4perl&apos;s loggers with the standard
       Log::Log4perl loggers and macros. While initialization requires Log4perl
       to perform dark magic to conform to Catalyst&apos;s different logging
       strategy, obtaining Log4perl&apos;s logger objects or calling its macros are
       unchanged.

       Instead of using Catalyst&apos;s way of referencing the &quot;context&quot; object $c to
       obtain logger references via its log() method, you can just as well use
       Log4perl&apos;s get_logger() or macros to access Log4perl&apos;s logger singletons.
       The result is the same.

COPYRIGHT AND LICENSE
       Copyright 2002-2010 by Mike Schilli &lt;m@perlmeister.com&gt;

       This library is free software; you can redistribute it and/or modify it
       under the same terms as Perl itself.



perl v5.10.1                       2010-07-21                      Catalyst(3pm)

</pre></body></html>
