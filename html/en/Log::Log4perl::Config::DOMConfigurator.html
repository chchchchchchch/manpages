<html>
<head><meta charset=utf-8/>
<title>Log::Log4perl::Config::DOMConfigurator - reads xml config files</title></head>
<body><pre>

Config::DOMConfiguratorUser)Contributed Perl DocumenConfig::DOMConfigurator(3pm)



NAME
       Log::Log4perl::Config::DOMConfigurator - reads xml config files

SYNOPSIS
           --------------------------
           --using the log4j DTD--
           --------------------------

           &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
           &lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

           &lt;log4j:configuration xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;

           &lt;appender name=&quot;FileAppndr1&quot; class=&quot;org.apache.log4j.FileAppender&quot;&gt;
               &lt;layout class=&quot;Log::Log4perl::Layout::PatternLayout&quot;&gt;
                       &lt;param name=&quot;ConversionPattern&quot;
                              value=&quot;%d %4r [%t] %-5p %c %t - %m%n&quot;/&gt;
               &lt;/layout&gt;
               &lt;param name=&quot;File&quot; value=&quot;t/tmp/DOMtest&quot;/&gt;
               &lt;param name=&quot;Append&quot; value=&quot;false&quot;/&gt;
           &lt;/appender&gt;

           &lt;category name=&quot;a.b.c.d&quot; additivity=&quot;false&quot;&gt;
               &lt;level value=&quot;warn&quot;/&gt;  &lt;!-- note lowercase! --&gt;
               &lt;appender-ref ref=&quot;FileAppndr1&quot;/&gt;
           &lt;/category&gt;

          &lt;root&gt;
               &lt;priority value=&quot;warn&quot;/&gt;
               &lt;appender-ref ref=&quot;FileAppndr1&quot;/&gt;
          &lt;/root&gt;

          &lt;/log4j:configuration&gt;



          --------------------------
          --using the log4perl DTD--
          --------------------------

          &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
           &lt;!DOCTYPE log4perl:configuration SYSTEM &quot;log4perl.dtd&quot;&gt;

           &lt;log4perl:configuration xmlns:log4perl=&quot;http://log4perl.sourceforge.net/&quot;
               threshold=&quot;debug&quot; oneMessagePerAppender=&quot;true&quot;&gt;

           &lt;log4perl:appender name=&quot;jabbender&quot; class=&quot;Log::Dispatch::Jabber&quot;&gt;

                   &lt;param-nested name=&quot;login&quot;&gt;
                          &lt;param name=&quot;hostname&quot; value=&quot;a.jabber.server&quot;/&gt;
                          &lt;param name=&quot;password&quot; value=&quot;12345&quot;/&gt;
                          &lt;param name=&quot;port&quot;     value=&quot;5222&quot;/&gt;
                          &lt;param name=&quot;resource&quot; value=&quot;logger&quot;/&gt;
                          &lt;param name=&quot;username&quot; value=&quot;bobjones&quot;/&gt;
                   &lt;/param-nested&gt;

                   &lt;param name=&quot;to&quot; value=&quot;bob@a.jabber.server&quot;/&gt;

                   &lt;param-text name=&quot;to&quot;&gt;
                         mary@another.jabber.server
                   &lt;/param-text&gt;
&#12;                   &lt;log4perl:layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
                       &lt;param name=&quot;ConversionPattern&quot; value = &quot;%K xx %G %U&quot;/&gt;
                       &lt;cspec name=&quot;K&quot;&gt;
                           sub { return sprintf &quot;%1x&quot;, $$}
                       &lt;/cspec&gt;
                       &lt;cspec name=&quot;G&quot;&gt;
                           sub {return &apos;thisistheGcspec&apos;}
                       &lt;/cspec&gt;
                   &lt;/log4perl:layout&gt;
           &lt;/log4perl:appender&gt;

           &lt;log4perl:appender name=&quot;DBAppndr2&quot; class=&quot;Log::Log4perl::Appender::DBI&quot;&gt;
                     &lt;param name=&quot;warp_message&quot; value=&quot;0&quot;/&gt;
                     &lt;param name=&quot;datasource&quot; value=&quot;DBI:CSV:f_dir=t/tmp&quot;/&gt;
                     &lt;param name=&quot;bufferSize&quot; value=&quot;2&quot;/&gt;
                     &lt;param name=&quot;password&quot; value=&quot;sub { $ENV{PWD} }&quot;/&gt;
                     &lt;param name=&quot;username&quot; value=&quot;bobjones&quot;/&gt;

                     &lt;param-text name=&quot;sql&quot;&gt;
                         INSERT INTO log4perltest
                                   (loglevel, message, shortcaller, thingid,
                                   category, pkg, runtime1, runtime2)
                         VALUES
                                    (?,?,?,?,?,?,?,?)
                     &lt;/param-text&gt;

                      &lt;param-nested name=&quot;params&quot;&gt;
                           &lt;param name=&quot;1&quot; value=&quot;%p&quot;/&gt;
                           &lt;param name=&quot;3&quot; value=&quot;%5.5l&quot;/&gt;
                           &lt;param name=&quot;5&quot; value=&quot;%c&quot;/&gt;
                           &lt;param name=&quot;6&quot; value=&quot;%C&quot;/&gt;
                      &lt;/param-nested&gt;

                      &lt;layout class=&quot;Log::Log4perl::Layout::NoopLayout&quot;/&gt;
           &lt;/log4perl:appender&gt;

           &lt;category name=&quot;animal.dog&quot;&gt;
                      &lt;priority value=&quot;info&quot;/&gt;
                      &lt;appender-ref ref=&quot;jabbender&quot;/&gt;
                      &lt;appender-ref ref=&quot;DBAppndr2&quot;/&gt;
           &lt;/category&gt;

           &lt;category name=&quot;plant&quot;&gt;
                   &lt;priority value=&quot;debug&quot;/&gt;
                   &lt;appender-ref ref=&quot;DBAppndr2&quot;/&gt;
           &lt;/category&gt;

           &lt;PatternLayout&gt;
               &lt;cspec name=&quot;U&quot;&gt;&lt;![CDATA[
                   sub {
                       return &quot;UID $&lt; GID $(&quot;;
                   }
               ]]&gt;&lt;/cspec&gt;
           &lt;/PatternLayout&gt;

           &lt;/log4perl:configuration&gt;

DESCRIPTION
       This module implements an XML config, complementing the properties-style
       config described elsewhere.

WHY
       &quot;Why would I want my config in XML?&quot; you ask.  Well, there are a couple
       reasons you might want to.  Maybe you have a personal preference for XML.
       Maybe you manage your config with other tools that have an affinity for
       XML, like XML-aware editors or automated config generators.  Or maybe
       (and this is the big one) you don&apos;t like having to run your application
       just to check the syntax of your config file.

       By using an XML config and referencing a DTD, you can use a namespace-
       aware validating parser to see if your XML config at least follows the
       rules set in the DTD.

HOW
       To reference a DTD, drop this in after the &lt;?xml...&gt; declaration in your
       config file:

           &lt;!DOCTYPE log4perl:configuration SYSTEM &quot;log4perl.dtd&quot;&gt;

       That tells the parser to validate your config against the DTD in
       &quot;log4perl.dtd&quot;, which is available in the xml/ directory of the log4perl
       distribution.  Note that you&apos;ll also need to grab the log4j-1.2.dtd from
       there as well, since the it&apos;s included by log4perl.dtd.

       Namespace-aware validating parsers are not the norm in Perl.  But the
       Xerces project (http://xml.apache.org/xerces-c/index.html --lots of
       binaries available, even rpm&apos;s)  does provide just such a parser that you
       can use like this:

           StdInParse -ns -v &lt; my-log4perl-config.xml

       This module itself does not use a validating parser, the obvious one
       XML::DOM::ValParser doesn&apos;t seem to handle namespaces.

WHY TWO DTDs
       The log4j DTD is from the log4j project, they designed it to handle their
       needs.  log4perl has added some extensions to the original log4j
       functionality which needed some extensions to the log4j DTD.  If you
       aren&apos;t using these features then you can validate your config against the
       log4j dtd and know that you&apos;re using unadulterated log4j config tags.

       The features added by the log4perl dtd are:

       1 oneMessagePerAppender global setting
               log4perl.oneMessagePerAppender=1

       2 globally defined user conversion specifiers
               log4perl.PatternLayout.cspec.G=sub { return &quot;UID $&lt; GID $(&quot;; }

       3 appender-local custom conversion specifiers
                log4j.appender.appndr1.layout.cspec.K = sub {return sprintf &quot;%1x&quot;, $$ }

       4 nested options
                log4j.appender.jabbender          = Log::Dispatch::Jabber
                #(note how these are nested under &apos;login&apos;)
                log4j.appender.jabbender.login.hostname = a.jabber.server
                log4j.appender.jabbender.login.port     = 5222
                log4j.appender.jabbender.login.username = bobjones

       5 the log4perl-specific filters, see Log::Log4perl::Filter, lots of
       examples in t/044XML-Filter.t, here&apos;s a short one:
             &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
             &lt;!DOCTYPE log4perl:configuration SYSTEM &quot;log4perl.dtd&quot;&gt;

             &lt;log4perl:configuration xmlns:log4perl=&quot;http://log4perl.sourceforge.net/&quot;&gt;

             &lt;appender name=&quot;A1&quot; class=&quot;Log::Log4perl::Appender::TestBuffer&quot;&gt;
                   &lt;layout class=&quot;Log::Log4perl::Layout::SimpleLayout&quot;/&gt;
                   &lt;filter class=&quot;Log::Log4perl::Filter::Boolean&quot;&gt;
                       &lt;param name=&quot;logic&quot; value=&quot;!Match3 &amp;amp;&amp;amp; (Match1 || Match2)&quot;/&gt;
                   &lt;/filter&gt;
             &lt;/appender&gt;

             &lt;appender name=&quot;A2&quot; class=&quot;Log::Log4perl::Appender::TestBuffer&quot;&gt;
                   &lt;layout class=&quot;Log::Log4perl::Layout::SimpleLayout&quot;/&gt;
                   &lt;filter-ref id=&quot;Match1&quot;/&gt;
             &lt;/appender&gt;

             &lt;log4perl:filter name=&quot;Match1&quot; value=&quot;sub { /let this through/ }&quot; /&gt;

             &lt;log4perl:filter name=&quot;Match2&quot;&gt;
                   sub {
                       /and that, too/
                   }
              &lt;/log4perl:filter&gt;

             &lt;log4perl:filter name=&quot;Match3&quot; class=&quot;Log::Log4perl::Filter::StringMatch&quot;&gt;
               &lt;param name=&quot;StringToMatch&quot; value=&quot;suppress&quot;/&gt;
               &lt;param name=&quot;AcceptOnMatch&quot; value=&quot;true&quot;/&gt;
             &lt;/log4perl:filter&gt;

             &lt;log4perl:filter name=&quot;MyBoolean&quot; class=&quot;Log::Log4perl::Filter::Boolean&quot;&gt;
               &lt;param name=&quot;logic&quot; value=&quot;!Match3 &amp;amp;&amp;amp; (Match1 || Match2)&quot;/&gt;
             &lt;/log4perl:filter&gt;


              &lt;root&gt;
                      &lt;priority value=&quot;info&quot;/&gt;
                      &lt;appender-ref ref=&quot;A1&quot;/&gt;
              &lt;/root&gt;

              &lt;/log4perl:configuration&gt;

       So we needed to extend the log4j dtd to cover these additions.  Now I
       could have just taken a &apos;steal this code&apos; approach and mixed parts of the
       log4j dtd into a log4perl dtd, but that would be cut-n-paste programming.
       So I&apos;ve used namespaces and

       &#183;   replaced three elements:

           &lt;log4perl:configuration&gt;
               handles #1) and accepts &lt;PatternLayout&gt;

           &lt;log4perl:appender&gt;
               accepts &lt;param-nested&gt; and &lt;param-text&gt;

           &lt;log4perl:layout&gt;
               accepts custom cspecs for #3)

       &#183;   added a &lt;param-nested&gt; element (complementing the &lt;param&gt; element)
               to handle #4)

       &#183;   added a root &lt;PatternLayout&gt; element to handle #2)

       &#183;   added &lt;param-text&gt; which lets you put things like perl code
               into escaped CDATA between the tags, so you don&apos;t have to worry
               about escaping characters and quotes

       &#183;   added &lt;cspec&gt;

       See the examples up in the &quot;SYNOPSIS&quot; for how all that gets used.

WHY NAMESPACES
       I liked the idea of using the log4j DTD in situ, so I used namespaces to
       extend it.  If you really don&apos;t like having to type &lt;log4perl:appender&gt;
       instead of just &lt;appender&gt;, you can make your own DTD combining the two
       DTDs and getting rid of the namespace prefixes.  Then you can validate
       against that, and log4perl should accept it just fine.

VARIABLE SUBSTITUTION
       This supports variable substitution like &quot;${foobar}&quot; in text and in
       attribute values except for appender-ref.  If an environment variable is
       defined for that name, its value is substituted. So you can do stuff like

               &lt;param name=&quot;${hostname}&quot; value=&quot;${hostnameval}.foo.com&quot;/&gt;
               &lt;param-text name=&quot;to&quot;&gt;${currentsysadmin}@foo.com&lt;/param-text&gt;

REQUIRES
       To use this module you need XML::DOM installed.

       To use the log4perl.dtd, you&apos;ll have to reference it in your XML config,
       and you&apos;ll also need to note that log4perl.dtd references the log4j dtd
       as &quot;log4j-1.2.dtd&quot;, so your validator needs to be able to find that file
       as well.  If you don&apos;t like having to schlep two files around, feel free
       to dump the contents of &quot;log4j-1.2.dtd&quot; into your &quot;log4perl.dtd&quot; file.

CAVEATS
       You can&apos;t mix a multiple param-nesteds with the same name, I&apos;m going to
       leave that for now, there&apos;s presently no need for a list of structs in
       the config.

CHANGES
       0.03 2/26/2003 Added support for log4perl extensions to the log4j dtd

SEE ALSO
       t/038XML-DOM1.t, t/039XML-DOM2.t for examples

       xml/log4perl.dtd, xml/log4j-1.2.dtd

       Log::Log4perl::Config

       Log::Log4perl::Config::PropertyConfigurator

       Log::Log4perl::Config::LDAPConfigurator (coming soon!)

       The code is brazenly modeled on log4j&apos;s DOMConfigurator class, (by
       Christopher Taylor, Ceki GA~XlcA~X, and Anders Kristensen) and any
       perceived similarity is not coincidental.

COPYRIGHT AND LICENSE
       Copyright 2002-2009 by Mike Schilli &lt;m@perlmeister.com&gt; and Kevin Goess
       &lt;cpan@goess.org&gt;.

       This library is free software; you can redistribute it and/or modify it
       under the same terms as Perl itself.



perl v5.10.1                       2010-07-21       Config::DOMConfigurator(3pm)

</pre></body></html>
