<html>
<head><meta charset=utf-8/>
<title>Net::DNS::Packet - DNS packet object class</title></head>
<body><pre>

Net::DNS::Packet(3pm)  User Contributed Perl Documentation Net::DNS::Packet(3pm)



NAME
       Net::DNS::Packet - DNS packet object class

SYNOPSIS
       &quot;use Net::DNS::Packet;&quot;

DESCRIPTION
       A &quot;Net::DNS::Packet&quot; object represents a DNS packet.

METHODS
   new
           $packet = Net::DNS::Packet-&gt;new(&quot;example.com&quot;);
           $packet = Net::DNS::Packet-&gt;new(&quot;example.com&quot;, &quot;MX&quot;, &quot;IN&quot;);

           $packet = Net::DNS::Packet-&gt;new(\$data);
           $packet = Net::DNS::Packet-&gt;new(\$data, 1);  # set debugging

           ($packet, $err) = Net::DNS::Packet-&gt;new(\$data);

           $packet = Net::DNS::Packet-&gt;new();

       If passed a domain, type, and class, &quot;new&quot; creates a packet object
       appropriate for making a DNS query for the requested information.  The
       type and class can be omitted; they default to A and IN.

       If passed a reference to a scalar containing DNS packet data, &quot;new&quot;
       creates a packet object from that data.  A second argument can be passed
       to turn on debugging output for packet parsing.

       If called in array context, returns a packet object and an error string.
       The error string will only be defined if the packet object is undefined
       (i.e., couldn&apos;t be created).

       Returns undef if unable to create a packet object (e.g., if the packet
       data is truncated).

       If called with an empty argument list, &quot;new&quot; creates an empty packet.

   data
           $data = $packet-&gt;data;

       Returns the packet data in binary format, suitable for sending to a
       nameserver.

   header
           $header = $packet-&gt;header;

       Returns a &quot;Net::DNS::Header&quot; object representing the header section of
       the packet.

   question, zone
           @question = $packet-&gt;question;

       Returns a list of &quot;Net::DNS::Question&quot; objects representing the question
       section of the packet.

       In dynamic update packets, this section is known as &quot;zone&quot; and specifies
       the zone to be updated.

   answer, pre, prerequisite
           @answer = $packet-&gt;answer;
&#12;       Returns a list of &quot;Net::DNS::RR&quot; objects representing the answer section
       of the packet.

       In dynamic update packets, this section is known as &quot;pre&quot; or
       &quot;prerequisite&quot; and specifies the RRs or RRsets which must or must not
       preexist.

   authority, update
           @authority = $packet-&gt;authority;

       Returns a list of &quot;Net::DNS::RR&quot; objects representing the authority
       section of the packet.

       In dynamic update packets, this section is known as &quot;update&quot; and
       specifies the RRs or RRsets to be added or deleted.

   additional
           @additional = $packet-&gt;additional;

       Returns a list of &quot;Net::DNS::RR&quot; objects representing the additional
       section of the packet.

   print
           $packet-&gt;print;

       Prints the packet data on the standard output in an ASCII format similar
       to that used in DNS zone files.

   string
           print $packet-&gt;string;

       Returns a string representation of the packet.

   answerfrom
           print &quot;packet received from &quot;, $packet-&gt;answerfrom, &quot;\n&quot;;

       Returns the IP address from which we received this packet.  User-created
       packets will return undef for this method.

   answersize
           print &quot;packet size: &quot;, $packet-&gt;answersize, &quot; bytes\n&quot;;

       Returns the size of the packet in bytes as it was received from a
       nameserver.  User-created packets will return undef for this method (use
       &quot;length $packet-&gt;data&quot; instead).

   push
           $ancount = $packet-&gt;push(pre        =&gt; $rr);
           $nscount = $packet-&gt;push(update     =&gt; $rr);
           $arcount = $packet-&gt;push(additional =&gt; $rr);

           $nscount = $packet-&gt;push(update =&gt; $rr1, $rr2, $rr3);
           $nscount = $packet-&gt;push(update =&gt; @rr);

       Adds RRs to the specified section of the packet.

       Returns the number of resource records in the specified section.

   unique_push
           $ancount = $packet-&gt;unique_push(pre        =&gt; $rr);
           $nscount = $packet-&gt;unique_push(update     =&gt; $rr);
           $arcount = $packet-&gt;unique_push(additional =&gt; $rr);

           $nscount = $packet-&gt;unique_push(update =&gt; $rr1, $rr2, $rr3);
           $nscount = $packet-&gt;unique_push(update =&gt; @rr);
&#12;       Adds RRs to the specified section of the packet provided that the RRs do
       not already exist in the packet.

       Returns the number of resource records in the specified section.

   safe_push
       A deprecated name for &quot;unique_push()&quot;.

   pop
           my $rr = $packet-&gt;pop(&quot;pre&quot;);
           my $rr = $packet-&gt;pop(&quot;update&quot;);
           my $rr = $packet-&gt;pop(&quot;additional&quot;);
           my $rr = $packet-&gt;pop(&quot;question&quot;);

       Removes RRs from the specified section of the packet.

   dn_comp
           $compname = $packet-&gt;dn_comp(&quot;foo.example.com&quot;, $offset);

       Returns a domain name compressed for a particular packet object, to be
       stored beginning at the given offset within the packet data.  The name
       will be added to a running list of compressed domain names for future
       use.

   dn_expand
           use Net::DNS::Packet qw(dn_expand);
           ($name, $nextoffset) = dn_expand(\$data, $offset);

           ($name, $nextoffset) = Net::DNS::Packet::dn_expand(\$data, $offset);

       Expands the domain name stored at a particular location in a DNS packet.
       The first argument is a reference to a scalar containing the packet data.
       The second argument is the offset within the packet where the (possibly
       compressed) domain name is stored.

       Returns the domain name and the offset of the next location in the
       packet.

       Returns (undef) if the domain name couldn&apos;t be expanded.

   sign_tsig
           $key_name = &quot;tsig-key&quot;;
           $key      = &quot;awwLOtRfpGE+rRKF2+DEiw==&quot;;

           $update = Net::DNS::Update-&gt;new(&quot;example.com&quot;);
           $update-&gt;push(&quot;update&quot;, rr_add(&quot;foo.example.com A 10.1.2.3&quot;));

           $update-&gt;sign_tsig($key_name, $key);

           $response = $res-&gt;send($update);

       Signs a packet with a TSIG resource record (see RFC 2845).  Uses the
       following defaults:

           algorithm   = HMAC-MD5.SIG-ALG.REG.INT
           time_signed = current time
           fudge       = 300 seconds

       If you wish to customize the TSIG record, you&apos;ll have to create it
       yourself and call the appropriate Net::DNS::RR::TSIG methods.  The
       following example creates a TSIG record and sets the fudge to 60 seconds:

           $key_name = &quot;tsig-key&quot;;
           $key      = &quot;awwLOtRfpGE+rRKF2+DEiw==&quot;;

           $tsig = Net::DNS::RR-&gt;new(&quot;$key_name TSIG $key&quot;);
           $tsig-&gt;fudge(60);

           $query = Net::DNS::Packet-&gt;new(&quot;www.example.com&quot;);
           $query-&gt;sign_tsig($tsig);

           $response = $res-&gt;send($query);

       You shouldn&apos;t modify a packet after signing it; otherwise authentication
       will probably fail.

   sign_sig0
       SIG0 support is provided through the Net::DNS::RR::SIG class. This class
       is not part of the default Net::DNS distribution but resides in the
       Net::DNS::SEC distribution.

           $update = Net::DNS::Update-&gt;new(&quot;example.com&quot;);
           $update-&gt;push(&quot;update&quot;, rr_add(&quot;foo.example.com A 10.1.2.3&quot;));
           $update-&gt;sign_sig0(&quot;Kexample.com+003+25317.private&quot;);

       SIG0 support is experimental see Net::DNS::RR::SIG for details.

       The method will call &quot;Carp::croak()&quot; if Net::DNS::RR::SIG cannot be
       found.

   truncate
       The truncate method takes a maximum length as argument and then tries to
       truncate the packet an set the TC bit according to the rules of RFC2181
       Section 9.

       The minimum maximum length that is honored is 512 octets.

COPYRIGHT
       Copyright (c) 1997-2002 Michael Fuhr.

       Portions Copyright (c) 2002-2004 Chris Reinhardt.

       Portions Copyright (c) 2002-2009 Olaf Kolkman

       Portions Copyright (c) 2007-2008 Dick Franks

       All rights reserved.  This program is free software; you may redistribute
       it and/or modify it under the same terms as Perl itself.

SEE ALSO
       perl(1), Net::DNS, Net::DNS::Resolver, Net::DNS::Update,
       Net::DNS::Header, Net::DNS::Question, Net::DNS::RR, RFC 1035 Section 4.1,
       RFC 2136 Section 2, RFC 2845



perl v5.14.2                       2009-12-30              Net::DNS::Packet(3pm)

</pre></body></html>
