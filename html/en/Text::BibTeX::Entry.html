<html>
<head><meta charset=utf-8/>
<title>Text::BibTeX::Entry - read and parse BibTeX files</title></head>
<body><pre>

Text::BibTeX::Entry(3pmUser Contributed Perl DocumentatiText::BibTeX::Entry(3pm)



NAME
       Text::BibTeX::Entry - read and parse BibTeX files

SYNOPSIS
          use Text::BibTeX;            # do not use Text::BibTeX::Entry alone!

          # ...assuming that $bibfile and $newbib are both objects of class
          # Text::BibTeX::File, opened for reading and writing (respectively):

          # Entry creation/parsing methods:
          $entry = new Text::BibTeX::Entry;
          $entry-&gt;read ($bibfile);
          $entry-&gt;parse ($filename, $filehandle);
          $entry-&gt;parse_s ($entry_text);

          # or:
          $entry = new Text::BibTeX::Entry $bibfile;
          $entry = new Text::BibTeX::Entry $filename, $filehandle;
          $entry = new Text::BibTeX::Entry $entry_text;

          # Entry query methods
          warn &quot;error in input&quot; unless $entry-&gt;parse_ok;
          $metatype = $entry-&gt;metatype;
          $type = $entry-&gt;type;

          # if metatype is BTE_REGULAR or BTE_MACRODEF:
          $key = $entry-&gt;key;                  # only for BTE_REGULAR metatype
          $num_fields = $entry-&gt;num_fields;
          @fieldlist = $entry-&gt;fieldlist;
          $has_title = $entry-&gt;exists (&apos;title&apos;);
          $title = $entry-&gt;get (&apos;title&apos;);
          # or:
          ($val1,$val2,...$valn) = $entry-&gt;get ($field1, $field2, ..., $fieldn);

          # if metatype is BTE_COMMENT or BTE_PREAMBLE:
          $value = $entry-&gt;value;

          # Author name methods
          @authors = $entry-&gt;split (&apos;author&apos;);
          ($first_author) = $entry-&gt;names (&apos;author&apos;);

          # Entry modification methods
          $entry-&gt;set_type ($new_type);
          $entry-&gt;set_key ($new_key);
          $entry-&gt;set (&apos;title&apos;, $new_title);
          # or:
          $entry-&gt;set ($field1, $val1, $field2, $val2, ..., $fieldn, $valn);
          $entry-&gt;delete (@fields);
          $entry-&gt;set_fieldlist (\@fieldlist);

          # Entry output methods
          $entry-&gt;write ($newbib);
          $entry-&gt;print ($filehandle);
          $entry_text = $entry-&gt;print_s;

          # Miscellaneous methods
          $entry-&gt;warn ($entry_warning);
          # or:
          $entry-&gt;warn ($field_warning, $field);

DESCRIPTION
       &quot;Text::BibTeX::Entry&quot; does all the real work of reading and parsing
       BibTeX files.  (Well, actually it just provides an object-oriented Perl
       front-end to a C library that does all that.  But that&apos;s not important
       right now.)

       BibTeX entries can be read either from &quot;Text::BibTeX::File&quot; objects
       (using the &quot;read&quot; method), or directly from a filehandle (using the
       &quot;parse&quot; method), or from a string (using &quot;parse_s&quot;).  The first is
       preferable, since you don&apos;t have to worry about supplying the filename,
       and because of the extra functionality provided by the
       &quot;Text::BibTeX::File&quot; class.  Currently, this means that you may specify
       the database structure to which entries are expected to conform via the
       &quot;File&quot; class.  This lets you ensure that entries follow the rules for
       required fields and mutually constrained fields for a particular type of
       database, and also gives you access to all the methods of the structured
       entry class for this database structure.  See Text::BibTeX::Structure for
       details on database structures.

       Once you have the entry, you can query it or change it in a variety of
       ways.  The query methods are &quot;parse_ok&quot;, &quot;type&quot;, &quot;key&quot;, &quot;num_fields&quot;,
       &quot;fieldlist&quot;, &quot;exists&quot;, and &quot;get&quot;.  Methods for changing the entry are
       &quot;set_type&quot;, &quot;set_key&quot;, &quot;set_fieldlist&quot;, &quot;delete&quot;, and &quot;set&quot;.

       Finally, you can output BibTeX entries, again either to an open
       &quot;Text::BibTeX::File&quot; object, a filehandle or a string.  (A filehandle or
       &quot;File&quot; object must, of course, have been opened in write mode.)  Output
       to a &quot;File&quot; object is done with the &quot;write&quot; method, to a filehandle via
       &quot;print&quot;, and to a string with &quot;print_s&quot;.  Using the &quot;File&quot; class is
       recommended for future extensibility, although it currently doesn&apos;t offer
       anything extra.

METHODS
   Entry creation/parsing methods
       new ([SOURCE])
           Creates a new &quot;Text::BibTeX::Entry&quot; object.  If the SOURCE parameter
           is supplied, it must be one of the following: a &quot;Text::BibTeX::File&quot;
           (or descendant class) object, a filename/filehandle pair, or a
           string.  Calls &quot;read&quot; to read from a &quot;Text::BibTeX::File&quot; object,
           &quot;parse&quot; to read from a filehandle, and &quot;parse_s&quot; to read from a
           string.

           A filehandle can be specified as a GLOB reference, or as an
           &quot;IO::Handle&quot; (or descendants) object, or as a &quot;FileHandle&quot; (or
           descendants) object.  (But there&apos;s really no point in using
           &quot;FileHandle&quot; objects, since &quot;Text::BibTeX&quot; requires Perl 5.004, which
           always includes the &quot;IO&quot; modules.)  You can not pass in the name of a
           filehandle as a string, though, because &quot;Text::BibTeX::Entry&quot;
           conforms to the &quot;use strict&quot; pragma (which disallows such symbolic
           references).

           The corresponding filename should be supplied in order to allow for
           accurate error messages; if you simply don&apos;t have the filename, you
           can pass &quot;undef&quot; and you&apos;ll get error messages without a filename.
           (It&apos;s probably better to rearrange your code so that the filename is
           available, though.)

           Thus, the following are equivalent to read from a file named by
           $filename (error handling ignored):

              # good ol&apos; fashioned filehandle and GLOB ref
              open (BIBFILE, $filename);
              $entry = new Text::BibTeX::Entry ($filename, \*BIBFILE);

              # newfangled IO::File thingy
              $file = new IO::File $filename;
              $entry = new Text::BibTeX::Entry ($filename, $file);

           But using a &quot;Text::BibTeX::File&quot; object is simpler and preferred:
&#12;              $file = new Text::BibTeX::File $filename;
              $entry = new Text::BibTeX::Entry $file;

           Returns the new object, unless SOURCE is supplied and reading/parsing
           the entry fails (e.g., due to end of file) -- then it returns false.

       read (BIBFILE)
           Reads and parses an entry from BIBFILE, which must be a
           &quot;Text::BibTeX::File&quot; object (or descendant).  The next entry will be
           read from the file associated with that object.

           Returns the same as &quot;parse&quot; (or &quot;parse_s&quot;): false if no entry found
           (e.g., at end-of-file), true otherwise.  To see if the parse itself
           failed (due to errors in the input), call the &quot;parse_ok&quot; method.

       parse (FILENAME, FILEHANDLE)
           Reads and parses the next entry from FILEHANDLE.  (That is, it scans
           the input until an &apos;@&apos; sign is seen, and then slurps up to the next
           &apos;@&apos; sign.  Everything between the two &apos;@&apos; signs [including the first
           one, but not the second one -- it&apos;s pushed back onto the input stream
           for the next entry] is parsed as a BibTeX entry, with the
           simultaneous construction of an abstract syntax tree [AST].  The AST
           is traversed to ferret out the most interesting information, and this
           is stuffed into a Perl hash, which coincidentally is the
           &quot;Text::BibTeX::Entry&quot; object you&apos;ve been tossing around.  But you
           don&apos;t need to know any of that -- I just figured if you&apos;ve read this
           far, you might want to know something about the inner workings of
           this module.)

           The success of the parse is stored internally so that you can later
           query it with the &quot;parse_ok&quot; method.  Even in the presence of syntax
           errors, you&apos;ll usually get something resembling your input, but it&apos;s
           usually not wise to try to do anything with it.  Just call
           &quot;parse_ok&quot;, and if it returns false then silently skip to the next
           entry.  (The error messages printed out by the parser should be quite
           adequate for the user to figure out what&apos;s wrong.  And no, there&apos;s
           currently no way for you to capture or redirect those error messages
           -- they&apos;re always printed to &quot;stderr&quot; by the underlying C code.  That
           should change in future releases.)

           If no &apos;@&apos; signs are seen on the input before reaching end-of-file,
           then we&apos;ve exhausted all the entries in the file, and &quot;parse&quot; returns
           a false value.  Otherwise, it returns a true value -- even if there
           were syntax errors.  Hence, it&apos;s important to check &quot;parse_ok&quot;.

           The FILENAME parameter is only used for generating error messages,
           but anybody using your program will certainly appreciate your setting
           it correctly!

       parse_s (TEXT)
           Parses a BibTeX entry (using the above rules) from the string TEXT.
           The string is not modified; repeatedly calling &quot;parse_s&quot; with the
           same string will give you the same results each time.  Thus, there&apos;s
           no point in putting multiple entries in one string.

   Entry query methods
       parse_ok ()
           Returns false if there were any serious errors encountered while
           parsing the entry.  (A &quot;serious&quot; error is a lexical or syntax error;
           currently, warnings such as &quot;undefined macro&quot; result in an error
           message being printed to &quot;stderr&quot; for the user&apos;s edification, but no
           notice is available to the calling code.)

       type ()
           Returns the type of the entry.  (The `type&apos; is the word that follows
           the &apos;@&apos; sign; e.g. `article&apos;, `book&apos;, `inproceedings&apos;, etc. for the
           standard BibTeX styles.)

       metatype ()
           Returns the metatype of the entry.  (The `metatype&apos; is a numeric
           value used to classify entry types into four groups: comment,
           preamble, macro definition (@string entries), and regular (all other
           entry types).  &quot;Text::BibTeX&quot; exports four constants for these
           metatypes: &quot;BTE_COMMENT&quot;, &quot;BTE_PREAMBLE&quot;, &quot;BTE_MACRODEF&quot;, and
           &quot;BTE_REGULAR&quot;.)

       key ()
           Returns the key of the entry.  (The key is the token immediately
           following the opening `{&apos; or `(&apos; in &quot;regular&quot; entries.  Returns
           &quot;undef&quot; for entries that don&apos;t have a key, such as macro definition
           (@string) entries.)

       num_fields ()
           Returns the number of fields in the entry.  (Note that, currently,
           this is not equivalent to putting &quot;scalar&quot; in front of a call to
           &quot;fieldlist&quot;.  See below for the consequences of calling &quot;fieldlist&quot;
           in a scalar context.)

       fieldlist ()
           Returns the list of fields in the entry.  In a scalar context,
           returns a reference to the object&apos;s own list of fields.  That way,
           you can change or reorder the field list with minimal interference
           from the class.  I&apos;m not entirely sure if this is a good idea, so
           don&apos;t rely on it existing in the future; feel free to play around
           with it and let me know if you get bitten in dangerous ways or find
           this enormously useful.

       exists (FIELD)
           Returns true if a field named FIELD is present in the entry, false
           otherwise.

       get (FIELD, ...)
           Returns the value of one or more FIELDs, as a list of values.  For
           example:

              $author = $entry-&gt;get (&apos;author&apos;);
              ($author, $editor) = $entry-&gt;get (&apos;author&apos;, &apos;editor&apos;);

           If a FIELD is not present in the entry, &quot;undef&quot; will be returned at
           its place in the return list.  However, you can&apos;t completely trust
           this as a test for presence or absence of a field; it is possible for
           a field to be present but undefined.  Currently this can only happen
           due to certain syntax errors in the input, or if you pass an
           undefined value to &quot;set&quot;, or if you create a new field with
           &quot;set_fieldlist&quot; (the new field&apos;s value is implicitly set to &quot;undef&quot;).

           Normally, the field value is what the input looks like after &quot;maximal
           processing&quot;--quote characters are removed, whitespace is collapsed
           (the same way that BibTeX itself does it), macros are expanded, and
           multiple tokens are pasted together.  (See bt_postprocess for details
           on the post-processing performed by btparse.)

           For example, if your input file has the following:

              @string{of = &quot;of&quot;}
              @string{foobars = &quot;Foobars&quot;}

              @article{foobar,
                title = {   The Mating Habits      } # of # &quot; Adult   &quot; # foobars
              }

           then using &quot;get&quot; to query the value of the &quot;title&quot; field from the
           &quot;foobar&quot; entry would give the string &quot;The Mating Habits of Adult
           Foobars&quot;.

           However, in certain circumstances you may wish to preserve the values
           as they appear in the input.  This is done by setting a
           &quot;preserve_values&quot; flag at some point; then, &quot;get&quot; will return not
           strings but &quot;Text::BibTeX::Value&quot; objects.  Each &quot;Value&quot; object is a
           list of &quot;Text::BibTeX::SimpleValue&quot; objects, which in turn consists
           of a simple value type (string, macro, or number) and the text of the
           simple value.  Various ways to set the &quot;preserve_values&quot; flag and the
           interface to both &quot;Value&quot; and &quot;SimpleValue&quot; objects are described in
           Text::BibTeX::Value.

       value ()
           Retuns the single string associated with @comment and @preamble
           entries.  For instance, the entry

              @preamble{&quot; This is   a preamble&quot; #
                        {---the concatenation of several strings}}

           would return a value of &quot;This is a preamble---the concatenation of
           several strings&quot;.

           If this entry was parsed in &quot;value preservation&quot; mode, then &quot;value&quot;
           acts like &quot;get&quot;, and returns a &quot;Value&quot; object rather than a simple
           string.

   Author name methods
       This is the only part of the module that makes any assumption about the
       nature of the data, namely that certain fields are lists delimited by a
       simple word such as &quot;and&quot;, and that the delimited sub-strings are human
       names of the &quot;First von Last&quot; or &quot;von Last, Jr., First&quot; style used by
       BibTeX.  If you are using this module for anything other than
       bibliographic data, you can most likely forget about these two methods.
       However, if you are in fact hacking on BibTeX-style bibliographic data,
       these could come in very handy -- the name-parsing done by BibTeX is not
       trivial, and the list-splitting would also be a pain to implement in Perl
       because you have to pay attention to brace-depth.  (Not that it wasn&apos;t a
       pain to implement in C -- it&apos;s just a lot more efficient than a Perl
       implementation would be.)

       Incidentally, both of these methods assume that the strings being split
       have already been &quot;collapsed&quot; in the BibTeX way, i.e. all leading and
       trailing whitespace removed and internal whitespace reduced to single
       spaces.  This should always be the case when using these two methods on a
       &quot;Text::BibTeX::Entry&quot; object, but these are actually just front ends to
       more general functions in &quot;Text::BibTeX&quot;.  (More general in that you
       supply the string to be parsed, rather than supplying the name of an
       entry field.)  Should you ever use those more general functions directly,
       you might have to worry about collapsing whitespace; see Text::BibTeX
       (the &quot;split_list&quot; and &quot;split_name&quot; functions in particular) for more
       information.

       Please note that the interface to author name parsing is experimental,
       subject to change, and open to discussion.  Please let me know if you
       have problems with it, think it&apos;s just perfect, or whatever.

       split (FIELD [, DELIM [, DESC]])
           Splits the value of FIELD on DELIM (default: `and&apos;).  Don&apos;t assume
           that this works the same as Perl&apos;s builtin &quot;split&quot; just because the
           names are the same: in particular, DELIM must be a simple string (no
           regexps), and delimiters that are at the beginning or end of the
           string, or at non-zero brace depth, or not surrounded by whitespace,
           are ignored.  Some examples might illuminate matters:

              if field F is...                then split (F) returns...
              &apos;Name1 and Name2&apos;               (&apos;Name1&apos;, &apos;Name2&apos;)
              &apos;Name1 and and Name2&apos;           (&apos;Name1&apos;, undef, &apos;Name2&apos;)
              &apos;Name1 and&apos;                     (&apos;Name1 and&apos;)
              &apos;and Name2&apos;                     (&apos;and Name2&apos;)
              &apos;Name1 {and} Name2 and Name3&apos;   (&apos;Name1 {and} Name2&apos;, &apos;Name3&apos;)
              &apos;{Name1 and Name2} and Name3&apos;   (&apos;{Name1 and Name2}&apos;, &apos;Name3&apos;)
&#12;           Note that a warning will be issued for empty names (as in the second
           example above).  A warning ought to be issued for delimiters at the
           beginning or end of a string, but currently this isn&apos;t done.  (Hmmm.)

           DESC is a one-word description of the substrings; it defaults to
           &apos;name&apos;.  It is only used for generating warning messages.

       names (FIELD)
           Splits FIELD as described above, and further splits each name into
           four components: first, von, last, and jr.

           Returns a list of &quot;Text::BibTeX::Name&quot; objects, each of which
           represents one name.  Use the &quot;part&quot; method to query these objects;
           see Text::BibTeX::Name for details on the interface to name objects
           (and on name-parsing as well).

           For example if this entry:

              @article{foo,
                       author = {John Smith and
                                 Hacker, J. Random and
                                 Ludwig van Beethoven and
                                 {Foo, Bar and Company}}}

           has been parsed into a &quot;Text::BibTeX::Entry&quot; object $entry, then

              @names = $entry-&gt;names (&apos;author&apos;);

           will put a list of &quot;Text::BibTeX::Name&quot; objects in @names.  These can
           be queried individually as described in Text::BibTeX::Name; for
           instance,

              @last = $names[0]-&gt;part (&apos;last&apos;);

           would put the list of tokens comprising the last name of the first
           author into the @last array: &quot;(&apos;Smith&apos;)&quot;.

   Entry modification methods
       set_type (TYPE)
           Sets the entry&apos;s type.

       set_metatype (METATYPE)
           Sets the entry&apos;s metatype (must be one of the four constants
           &quot;BTE_COMMENT&quot;, &quot;BTE_PREAMBLE&quot;, &quot;BTE_MACRODEF&quot;, and &quot;BTE_REGULAR&quot;,
           which are all optionally exported from &quot;Text::BibTeX&quot;).

       set_key (KEY)
           Sets the entry&apos;s key.

       set (FIELD, VALUE, ...)
           Sets the value of field FIELD.  (VALUE might be &quot;undef&quot; or
           unsupplied, in which case FIELD will simply be set to &quot;undef&quot; -- this
           is where the difference between the &quot;exists&quot; method and testing the
           definedness of field values becomes clear.)

           Multiple (FIELD, VALUE) pairs may be supplied; they will be processed
           in order (i.e. the input is treated like a list, not a hash).  For
           example:

              $entry-&gt;set (&apos;author&apos;, $author);
              $entry-&gt;set (&apos;author&apos;, $author, &apos;editor&apos;, $editor);

           VALUE can be either a simple string or a &quot;Text::BibTeX::Value&quot;
           object; it doesn&apos;t matter if the entry was parsed in &quot;full post-
           processing&quot; or &quot;preserve input values&quot; mode.

       delete (FIELD)
           Deletes field FIELD from an entry.

       set_fieldlist (FIELDLIST)
           Sets the entry&apos;s list of fields to FIELDLIST, which must be a list
           reference.  If any of the field names supplied in FIELDLIST are not
           currently present in the entry, they are created with the value
           &quot;undef&quot; and a warning is printed.  Conversely, if any of the fields
           currently present in the entry are not named in the list of fields
           supplied to &quot;set_fields&quot;, they are deleted from the entry and another
           warning is printed.

   Entry output methods
       write (BIBFILE)
           Prints a BibTeX entry on the filehandle associated with BIBFILE
           (which should be a &quot;Text::BibTeX::File&quot; object, opened for output).
           Currently the printout is not particularly human-friendly; a highly
           configurable pretty-printer will be developed eventually.

       print (FILEHANDLE)
           Prints a BibTeX entry on FILEHANDLE.

       print_s ()
           Prints a BibTeX entry to a string, which is the return value.

   Miscellaneous methods
       warn (WARNING [, FIELD])
           Prepends a bit of location information (filename and line number(s))
           to WARNING, appends a newline, and passes it to Perl&apos;s &quot;warn&quot;.  If
           FIELD is supplied, the line number given is just that of the field;
           otherwise, the range of lines for the whole entry is given.  (Well,
           almost -- currently, the line number of the last field is used as the
           last line of the whole entry.  This is a bug.)

           For example, if lines 10-15 of file foo.bib look like this:

              @article{homer97,
                author = {Homer Simpson and Ned Flanders},
                title = {Territorial Imperatives in Modern Suburbia},
                journal = {Journal of Suburban Studies},
                year = 1997
              }

           then, after parsing this entry to $entry, the calls

              $entry-&gt;warn (&apos;what a silly entry&apos;);
              $entry-&gt;warn (&apos;what a silly journal&apos;, &apos;journal&apos;);

           would result in the following warnings being issued:

              foo.bib, lines 10-14: what a silly entry
              foo.bib, line 13: what a silly journal

       line ([FIELD])
           Returns the line number of FIELD.  If the entry was parsed from a
           string, this still works--it&apos;s just the line number relative to the
           start of the string.  If the entry was parsed from a file, this works
           just as you&apos;d expect it to: it returns the absolute line number with
           respect to the whole file.  Line numbers are one-based.

           If FIELD is not supplied, returns a two-element list containing the
           line numbers of the beginning and end of the whole entry.  (Actually,
           the &quot;end&quot; line number is currently inaccurate: it&apos;s really the the
           line number of the last field in the entry.  But it&apos;s better than
           nothing.)

       filename ()
           Returns the name of the file from which the entry was parsed.  Only
           works if the file is represented by a &quot;Text::BibTeX::File&quot;
           object---if you just passed a filename/filehandle pair to &quot;parse&quot;,
           you can&apos;t get the filename back.  (Sorry.)

SEE ALSO
       Text::BibTeX, Text::BibTeX::File, Text::BibTeX::Structure

AUTHOR
       Greg Ward &lt;gward@python.net&gt;
&#12;COPYRIGHT
       Copyright (c) 1997-2000 by Gregory P. Ward.  All rights reserved.  This
       file is part of the Text::BibTeX library.  This library is free software;
       you may redistribute it and/or modify it under the same terms as Perl
       itself.



perl v5.14.2                       2012-06-02           Text::BibTeX::Entry(3pm)

</pre></body></html>
