<html>
<head><meta charset=utf-8/>
<title>fmtmsg - print formatted error messages</title></head>
<body><pre>

FMTMSG(3)                   Linux Programmer&apos;s Manual                  FMTMSG(3)



NAME
       fmtmsg - print formatted error messages

SYNOPSIS
       #include &lt;fmtmsg.h&gt;

       int fmtmsg(long classification, const char *label,
                  int severity, const char *text,
                  const char *action, const char *tag);

DESCRIPTION
       This  function  displays  a  message  described  by  its arguments on the
       device(s) specified in the classification argument.  For messages written
       to stderr, the format depends on the MSGVERB environment variable.

       The label argument identifies the source of the message.  The string must
       consist of two colon separated parts where the first part  has  not  more
       than 10 and the second part not more than 14 characters.

       The text argument describes the condition of the error.

       The  action  argument describes possible steps to recover from the error.
       If it is printed, it is prefixed by &quot;TO FIX: &quot;.

       The tag argument is a reference to the online  documentation  where  more
       information can be found.  It should contain the label value and a unique
       identification number.

   Dummy arguments
       Each of the arguments can have a dummy value.  The  dummy  classification
       value  MM_NULLMC (0L) does not specify any output, so nothing is printed.
       The dummy severity value NO_SEV (0) says that no  severity  is  supplied.
       The  values  MM_NULLLBL,  MM_NULLTXT, MM_NULLACT, MM_NULLTAG are synonyms
       for ((char *) 0), the empty string,  and  MM_NULLSEV  is  a  synonym  for
       NO_SEV.

   The classification argument
       The  classification  argument  is the sum of values describing 4 types of
       information.

       The first value defines the output channel.

       MM_PRINT    Output to stderr.

       MM_CONSOLE  Output to the system console.

       MM_PRINT | MM_CONSOLE
                   Output to both.

       The second value is the source of the error:

       MM_HARD     A hardware error occurred.

       MM_FIRM     A firmware error occurred.

       MM_SOFT     A software error occurred.

       The third value encodes the detector of the problem:

       MM_APPL     It is detected by an application.

       MM_UTIL     It is detected by a utility.
&#12;       MM_OPSYS    It is detected by the operating system.

       The fourth value shows the severity of the incident:

       MM_RECOVER  It is a recoverable error.

       MM_NRECOV   It is a nonrecoverable error.

   The severity argument
       The severity argument can take one of the following values:

       MM_NOSEV    No severity is printed.

       MM_HALT     This value is printed as HALT.

       MM_ERROR    This value is printed as ERROR.

       MM_WARNING  This value is printed as WARNING.

       MM_INFO     This value is printed as INFO.

       The numeric values are between 0 and  4.   Using  addseverity(3)  or  the
       environment  variable  SEV_LEVEL  you  can add more levels and strings to
       print.

RETURN VALUE
       The function can return 4 values:

       MM_OK       Everything went smooth.

       MM_NOTOK    Complete failure.

       MM_NOMSG    Error writing to stderr.

       MM_NOCON    Error writing to the console.

ENVIRONMENT
       The environment variable MSGVERB (&quot;message verbosity&quot;)  can  be  used  to
       suppress parts of the output to stderr.  (It does not influence output to
       the console.)  When this variable is  defined,  is  non-NULL,  and  is  a
       colon-separated  list  of valid keywords, then only the parts of the mes&#8208;
       sage corresponding to these keywords  is  printed.   Valid  keywords  are
       &quot;label&quot;, &quot;severity&quot;, &quot;text&quot;, &quot;action&quot; and &quot;tag&quot;.

       The  environment variable SEV_LEVEL can be used to introduce new severity
       levels.  By default, only the five severity levels  described  above  are
       available.   Any  other  numeric value would make fmtmsg() print nothing.
       If the user puts SEV_LEVEL with a format like

              SEV_LEVEL=[description[:description[:...]]]

       in the environment of the process before  the  first  call  to  fmtmsg(),
       where each description is of the form

              severity-keyword,level,printstring

       then  fmtmsg()  will  also  accept the indicated values for the level (in
       addition to the standard levels 0-4), and use the  indicated  printstring
       when such a level occurs.

       The  severity-keyword  part  is  not  used  by  fmtmsg() but it has to be
       present.  The level part is a string representation  of  a  number.   The
       numeric  value  must be a number greater than 4.  This value must be used
       in the severity argument of fmtmsg() to select this  class.   It  is  not
       possible  to overwrite any of the predefined classes.  The printstring is
       the string printed when a message of this class is processed by fmtmsg().
&#12;VERSIONS
       fmtmsg() is provided in glibc since version 2.1.

CONFORMING TO
       The functions fmtmsg()  and  addseverity(3),  and  environment  variables
       MSGVERB  and SEV_LEVEL come from System V.  The function fmtmsg() and the
       environment variable MSGVERB are described in POSIX.1-2001.

NOTES
       System V and UnixWare man pages tell us that these  functions  have  been
       replaced  by  &quot;pfmt()  and  addsev()&quot; or by &quot;pfmt(), vpfmt(), lfmt(), and
       vlfmt()&quot;, and will be removed later.

EXAMPLE
       #include &lt;stdio.h&gt;
       #include &lt;stdlib.h&gt;
       #include &lt;fmtmsg.h&gt;

       int
       main(void)
       {
           long class = MM_PRINT | MM_SOFT | MM_OPSYS | MM_RECOVER;
           int err;

           err = fmtmsg(class, &quot;util-linux:mount&quot;, MM_ERROR,
                       &quot;unknown mount option&quot;, &quot;See mount(8).&quot;,
                       &quot;util-linux:mount:017&quot;);
           switch (err) {
           case MM_OK:
               break;
           case MM_NOTOK:
               printf(&quot;Nothing printed\n&quot;);
               break;
           case MM_NOMSG:
               printf(&quot;Nothing printed to stderr\n&quot;);
               break;
           case MM_NOCON:
               printf(&quot;No console output\n&quot;);
               break;
           default:
               printf(&quot;Unknown error from fmtmsg()\n&quot;);
           }
           exit(EXIT_SUCCESS);
       }

       The output should be:

           util-linux:mount: ERROR: unknown mount option
           TO FIX: See mount(8).  util-linux:mount:017

       and after

           MSGVERB=text:action; export MSGVERB

       the output becomes:

           unknown mount option
           TO FIX: See mount(8).

SEE ALSO
       addseverity(3), perror(3)

COLOPHON
       This page is part of release 3.44 of  the  Linux  man-pages  project.   A
       description  of the project, and information about reporting bugs, can be
       found at http://www.kernel.org/doc/man-pages/.



                                   2008-06-14                          FMTMSG(3)

</pre></body></html>
