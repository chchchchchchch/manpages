<html>
<head><meta charset=utf-8/>
<title>git-update-ref - Update the object name stored in a ref safely</title></head>
<body><pre>

GIT-UPDATE-REF(1)                  Git Manual                  GIT-UPDATE-REF(1)



NAME
       git-update-ref - Update the object name stored in a ref safely

SYNOPSIS
       git update-ref [-m &lt;reason&gt;] (-d &lt;ref&gt; [&lt;oldvalue&gt;] | [--no-deref] &lt;ref&gt; &lt;newvalue&gt; [&lt;oldvalue&gt;])


DESCRIPTION
       Given two arguments, stores the &lt;newvalue&gt; in the &lt;ref&gt;, possibly
       dereferencing the symbolic refs. E.g. git update-ref HEAD &lt;newvalue&gt;
       updates the current branch head to the new object.

       Given three arguments, stores the &lt;newvalue&gt; in the &lt;ref&gt;, possibly
       dereferencing the symbolic refs, after verifying that the current value
       of the &lt;ref&gt; matches &lt;oldvalue&gt;. E.g. git update-ref refs/heads/master
       &lt;newvalue&gt; &lt;oldvalue&gt; updates the master branch head to &lt;newvalue&gt; only
       if its current value is &lt;oldvalue&gt;. You can specify 40 &quot;0&quot; or an empty
       string as &lt;oldvalue&gt; to make sure that the ref you are creating does not
       exist.

       It also allows a &quot;ref&quot; file to be a symbolic pointer to another ref file
       by starting with the four-byte header sequence of &quot;ref:&quot;.

       More importantly, it allows the update of a ref file to follow these
       symbolic pointers, whether they are symlinks or these &quot;regular file
       symbolic refs&quot;. It follows real symlinks only if they start with &quot;refs/&quot;:
       otherwise it will just try to read them and update them as a regular file
       (i.e. it will allow the filesystem to follow them, but will overwrite
       such a symlink to somewhere else with a regular filename).

       If --no-deref is given, &lt;ref&gt; itself is overwritten, rather than the
       result of following the symbolic pointers.

       In general, using

           git update-ref HEAD &quot;$head&quot;

       should be a lot safer than doing

           echo &quot;$head&quot; &gt; &quot;$GIT_DIR/HEAD&quot;

       both from a symlink following standpoint and an error checking
       standpoint. The &quot;refs/&quot; rule for symlinks means that symlinks that point
       to &quot;outside&quot; the tree are safe: they&#8217;ll be followed for reading but not
       for writing (so we&#8217;ll never write through a ref symlink to some other
       tree, if you have copied a whole archive by creating a symlink tree).

       With -d flag, it deletes the named &lt;ref&gt; after verifying it still
       contains &lt;oldvalue&gt;.

LOGGING UPDATES
       If config parameter &quot;core.logAllRefUpdates&quot; is true and the ref is one
       under &quot;refs/heads/&quot;, &quot;refs/remotes/&quot;, &quot;refs/notes/&quot;, or the symbolic ref
       HEAD; or the file &quot;$GIT_DIR/logs/&lt;ref&gt;&quot; exists then git update-ref will
       append a line to the log file &quot;$GIT_DIR/logs/&lt;ref&gt;&quot; (dereferencing all
       symbolic refs before creating the log name) describing the change in ref
       value. Log lines are formatted as:

        1. oldsha1 SP newsha1 SP committer LF

           Where &quot;oldsha1&quot; is the 40 character hexadecimal value previously
           stored in &lt;ref&gt;, &quot;newsha1&quot; is the 40 character hexadecimal value of
           &lt;newvalue&gt; and &quot;committer&quot; is the committer&#8217;s name, email address and
           date in the standard GIT committer ident format.

       Optionally with -m:

        1. oldsha1 SP newsha1 SP committer TAB message LF

           Where all fields are as described above and &quot;message&quot; is the value
           supplied to the -m option.

       An update will fail (without changing &lt;ref&gt;) if the current user is
       unable to create a new log file, append to the existing log file or does
       not have committer information available.

GIT
       Part of the git(1) suite



Git 1.7.10.4                       11/24/2012                  GIT-UPDATE-REF(1)

</pre></body></html>
