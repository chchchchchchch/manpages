<html>
<head><meta charset=utf-8/>
<title>hcreate, hdestroy, hsearch, hcreate_r, hdestroy_r, hsearch_r - hash table management</title></head>
<body><pre>

HSEARCH(3)                  Linux Programmer&apos;s Manual                 HSEARCH(3)



NAME
       hcreate, hdestroy, hsearch, hcreate_r, hdestroy_r, hsearch_r - hash table
       management

SYNOPSIS
       #include &lt;search.h&gt;

       int hcreate(size_t nel);

       ENTRY *hsearch(ENTRY item, ACTION action);

       void hdestroy(void);

       #define _GNU_SOURCE         /* See feature_test_macros(7) */
       #include &lt;search.h&gt;

       int hcreate_r(size_t nel, struct hsearch_data *htab);

       int hsearch_r(ENTRY item, ACTION action, ENTRY **retval,
                     struct hsearch_data *htab);

       void hdestroy_r(struct hsearch_data *htab);

DESCRIPTION
       The three functions hcreate(), hsearch(), and hdestroy() allow the caller
       to create and manage a hash search table containing entries consisting of
       a key (a string) and associated data.  Using these  functions,  only  one
       hash table can be used at a time.

       The  three functions hcreate_r(), hsearch_r(), hdestroy_r() are reentrant
       versions that allow a program to use more than one hash search  table  at
       the  same  time.   The  last  argument,  htab, points to a structure that
       describes the table on which the function is to operate.  The  programmer
       should  treat  this structure as opaque (i.e., do not attempt to directly
       access or modify the fields in this structure).

       First a hash table must be created using  hcreate().   The  argument  nel
       specifies the maximum number of entries in the table.  (This maximum can&#8208;
       not be changed later, so  choose  it  wisely.)   The  implementation  may
       adjust this value upward to improve the performance of the resulting hash
       table.

       The hcreate_r() function performs the same task as hcreate(), but for the
       table described by the structure *htab.  The structure pointed to by htab
       must be zeroed before the first call to hcreate_r().

       The function hdestroy() frees the memory occupied by the hash table  that
       was  created by hcreate().  After calling hdestroy() a new hash table can
       be created using hcreate().  The hdestroy_r() function performs the anal&#8208;
       ogous task for a hash table described by *htab, which was previously cre&#8208;
       ated using hcreate_r().

       The hsearch() function searches the hash table for an item with the  same
       key as item (where &quot;the same&quot; is determined using strcmp(3)), and if suc&#8208;
       cessful returns a pointer to it.

       The argument item is of type ENTRY, which is  defined  in  &lt;search.h&gt;  as
       follows:

           typedef struct entry {
               char *key;
               void *data;
           } ENTRY;

       The field key points to a null-terminated string which is the search key.
       The field data points to data that is associated with that key.

       The argument action determines what hsearch() does after an  unsuccessful
       search.  This argument must either have the value ENTER, meaning insert a
       copy of item (and return a pointer to the new hash  table  entry  as  the
       function  result),  or  the  value  FIND,  meaning  that  NULL  should be
       returned.  (If action is FIND, then data is ignored.)

       The hsearch_r() function is like hsearch() but operates on the hash table
       described  by  *htab.  The hsearch_r() function differs from hsearch() in
       that a pointer to the found item is returned in *retval, rather  than  as
       the function result.

RETURN VALUE
       hcreate()  and  hcreate_r()  return nonzero on success.  They return 0 on
       error.

       On success, hsearch() returns a pointer to an entry in  the  hash  table.
       hsearch() returns NULL on error, that is, if action is ENTER and the hash
       table is full, or action is FIND and item cannot be found in the hash ta&#8208;
       ble.  hsearch_r() returns nonzero on success, and 0 on error.

ERRORS
       hcreate_r() and hdestroy_r() can fail for the following reasons:

       EINVAL htab is NULL.

       hsearch() and hsearch_r() can fail for the following reasons:

       ENOMEM action was ENTER, key was not found in the table, and there was no
              room in the table to add a new entry.

       ESRCH  action was FIND, and key was not found in the table.

       POSIX.1-2001 only specifies the ENOMEM error.

CONFORMING TO
       The functions hcreate(), hsearch(), and hdestroy() are from SVr4, and are
       described  in  POSIX.1-2001.  The functions hcreate_r(), hsearch_r(), and
       hdestroy_r() are GNU extensions.

NOTES
       Hash table implementations are usually more efficient when the table con&#8208;
       tains  enough  free  space to minimize collisions.  Typically, this means
       that nel should be at least 25% larger than the maximum  number  of  ele&#8208;
       ments that the caller expects to store in the table.

       The hdestroy() and hdestroy_r() functions do not free the buffers pointed
       to by the key and data elements of the hash table entries.  (It can&apos;t  do
       this because it doesn&apos;t know whether these buffers were allocated dynami&#8208;
       cally.)  If these buffers need to be freed (perhaps because  the  program
       is repeatedly creating and destroying hash tables, rather than creating a
       single table whose lifetime matches that of the program), then  the  pro&#8208;
       gram  must  maintain  bookkeeping  data  structures that allow it to free
       them.

BUGS
       SVr4 and POSIX.1-2001 specify that action is significant only for  unsuc&#8208;
       cessful  searches, so that an ENTER should not do anything for a success&#8208;
       ful search.  In libc and glibc (before version 2.3),  the  implementation
       violates  the  specification, updating the data for the given key in this
       case.
&#12;       Individual hash table entries can be added, but not deleted.

EXAMPLE
       The following program inserts 24 items into a  hash  table,  then  prints
       some of them.

       #include &lt;stdio.h&gt;
       #include &lt;stdlib.h&gt;
       #include &lt;search.h&gt;

       char *data[] = { &quot;alpha&quot;, &quot;bravo&quot;, &quot;charlie&quot;, &quot;delta&quot;,
            &quot;echo&quot;, &quot;foxtrot&quot;, &quot;golf&quot;, &quot;hotel&quot;, &quot;india&quot;, &quot;juliet&quot;,
            &quot;kilo&quot;, &quot;lima&quot;, &quot;mike&quot;, &quot;november&quot;, &quot;oscar&quot;, &quot;papa&quot;,
            &quot;quebec&quot;, &quot;romeo&quot;, &quot;sierra&quot;, &quot;tango&quot;, &quot;uniform&quot;,
            &quot;victor&quot;, &quot;whisky&quot;, &quot;x-ray&quot;, &quot;yankee&quot;, &quot;zulu&quot;
       };

       int
       main(void)
       {
           ENTRY e, *ep;
           int i;

           hcreate(30);

           for (i = 0; i &lt; 24; i++) {
               e.key = data[i];
               /* data is just an integer, instead of a
                  pointer to something */
               e.data = (void *) i;
               ep = hsearch(e, ENTER);
               /* there should be no failures */
               if (ep == NULL) {
                   fprintf(stderr, &quot;entry failed\n&quot;);
                   exit(EXIT_FAILURE);
               }
           }

           for (i = 22; i &lt; 26; i++) {
               /* print two entries from the table, and
                  show that two are not in the table */
               e.key = data[i];
               ep = hsearch(e, FIND);
               printf(&quot;%9.9s -&gt; %9.9s:%d\n&quot;, e.key,
                      ep ? ep-&gt;key : &quot;NULL&quot;, ep ? (int)(ep-&gt;data) : 0);
           }
           hdestroy();
           exit(EXIT_SUCCESS);
       }

SEE ALSO
       bsearch(3), lsearch(3), malloc(3), tsearch(3)

COLOPHON
       This  page  is  part  of  release 3.44 of the Linux man-pages project.  A
       description of the project, and information about reporting bugs, can  be
       found at http://www.kernel.org/doc/man-pages/.



GNU                                2011-09-10                         HSEARCH(3)

</pre></body></html>
