<html>
<head><meta charset=utf-8/>
<title>hosts_options - host access control language extensions</title></head>
<body><pre>

HOSTS_OPTIONS(5)                                                HOSTS_OPTIONS(5)



NAME
       hosts_options - host access control language extensions

DESCRIPTION
       This  document  describes  extensions  to  the  language described in the
       hosts_access(5) document.

       The extensible language uses the following format:

          daemon_list : client_list : option : option ...

       The first two fields are described in the  hosts_access(5)  manual  page.
       The  remainder  of  the rules is a list of zero or more options.  Any &quot;:&quot;
       characters within options should be protected with a backslash.

       An option is of the form &quot;keyword&quot; or &quot;keyword value&quot;. Options  are  pro&#8208;
       cessed  in  the  specified order. Some options are subjected to %&lt;letter&gt;
       substitutions. For the sake of backwards compatibility with earlier  ver&#8208;
       sions, an &quot;=&quot; is permitted between keyword and value.

LOGGING
       severity mail.info

       severity notice
              Change  the  severity  level  at  which  the event will be logged.
              Facility names (such as mail) are optional, and are not  supported
              on  systems with older syslog implementations. The severity option
              can be used to emphasize or to ignore specific events.

ACCESS CONTROL
       allow

       deny   Grant (deny) service. These options must appear at the  end  of  a
              rule.

       The  allow  and deny keywords make it possible to keep all access control
       rules within a single file, for example in the hosts.allow file.

       To permit access from specific hosts only:

          ALL: .friendly.domain: ALLOW
          ALL: ALL: DENY

       To permit access from all hosts except a few trouble makers:

          ALL: .bad.domain: DENY
          ALL: ALL: ALLOW

       Notice the leading dot on the domain name patterns.

RUNNING OTHER COMMANDS
       aclexec shell_command
              Execute, in a child process, the specified  shell  command,  after
              performing    the    %&lt;letter&gt;   expansions   described   in   the
              hosts_access(5) manual page.  The command is executed with  stdin,
              stdout  and  stderr connected to the null device, so that it won&apos;t
              mess up the conversation with the client host. Example:

                 smtp : ALL : aclexec checkdnsbl %a

              executes,  in  a  background  child  process,  the  shell  command
              &quot;checkdnsbl  %a&quot;  after  replacing %a by the address of the remote
              host.

              The connection will be allowed or refused depending on whether the
              command returns a true or false exit status.

       spawn shell_command
              Execute,  in  a  child process, the specified shell command, after
              performing   the   %&lt;letter&gt;   expansions   described    in    the
              hosts_access(5)  manual page.  The command is executed with stdin,
              stdout and stderr connected to the null device, so that  it  won&apos;t
              mess up the conversation with the client host. Example:

                 spawn (/usr/sbin/safe_finger -l @%h | /usr/bin/mail root) &amp;

              executes,  in  a  background  child  process,  the  shell  command
              &quot;safe_finger -l @%h | mail root&quot; after replacing %h by the name or
              address of the remote host.

              The  example uses the &quot;safe_finger&quot; command instead of the regular
              &quot;finger&quot; command, to limit possible damage from data sent  by  the
              finger  server.  The  &quot;safe_finger&quot;  command is part of the daemon
              wrapper package; it is a wrapper around the regular finger command
              that filters the data sent by the remote host.

       twist shell_command
              Replace  the current process by an instance of the specified shell
              command, after performing the %&lt;letter&gt;  expansions  described  in
              the  hosts_access(5)  manual  page.   Stdin, stdout and stderr are
              connected to the client process. This option must  appear  at  the
              end of a rule.

              To  send a customized bounce message to the client instead of run&#8208;
              ning the real ftp daemon:

                 in.ftpd : ... : twist /bin/echo 421 Some bounce message

              For an alternative way to talk to client processes, see  the  ban&#8208;
              ners option below.

              To  run  /some/other/in.telnetd without polluting its command-line
              array or its process environment:

                 in.telnetd : ... : twist PATH=/some/other; exec in.telnetd

              Warning:  in case of UDP services, do not twist to  commands  that
              use  the standard I/O or the read(2)/write(2) routines to communi&#8208;
              cate with the client process; UDP requires other I/O primitives.

NETWORK OPTIONS
       keepalive
              Causes the server to periodically send a message  to  the  client.
              The  connection  is  considered  broken  when  the client does not
              respond. The keepalive option can be useful when  users  turn  off
              their  machine  while  it  is  still  connected  to a server.  The
              keepalive option is not useful for datagram (UDP) services.

       linger number_of_seconds
              Specifies how long the kernel will try to deliver  not-yet  deliv&#8208;
              ered data after the server process closes a connection.

USERNAME LOOKUP
       rfc931 [ timeout_in_seconds ]
              Look  up  the  client  user name with the RFC 931 (TAP, IDENT, RFC
              1413) protocol.  This option is silently ignored in case  of  ser&#8208;
              vices  based  on  transports other than TCP.  It requires that the
              client system runs an RFC 931 (IDENT, etc.) -compliant daemon, and
              may   cause  noticeable  delays  with  connections  from  non-UNIX
              clients.  The timeout period is optional. If no timeout is  speci&#8208;
              fied a compile-time defined default value is taken.

MISCELLANEOUS
       banners /some/directory
              Look  for  a  file  in `/some/directory&#180; with the same name as the
              daemon process (for example in.telnetd for  the  telnet  service),
              and  copy  its  contents  to  the  client.  Newline characters are
              replaced by carriage-return newline, and %&lt;letter&gt;  sequences  are
              expanded (see the hosts_access(5) manual page).

              The  tcp wrappers source code distribution provides a sample make&#8208;
              file (Banners.Makefile) for convenient banner maintenance.

              Warning: banners are supported for connection-oriented (TCP)  net&#8208;
              work services only.

       nice [ number ]
              Change the nice value of the process (default 10).  Specify a pos&#8208;
              itive value to spend more CPU resources on other processes.

       setenv name value
              Place a (name, value) pair into the process environment. The value
              is  subjected  to  %&lt;letter&gt; expansions and may contain whitespace
              (but leading and trailing blanks are stripped off).

              Warning: many  network  daemons  reset  their  environment  before
              spawning a login or shell process.

       umask 022
              Like  the  umask command that is built into the shell. An umask of
              022 prevents the creation of files with group and world write per&#8208;
              mission.  The umask argument should be an octal number.

       user nobody

       user nobody.kmem
              Assume  the  privileges  of the &quot;nobody&quot; userid (or user &quot;nobody&quot;,
              group &quot;kmem&quot;). The first form is useful with inetd implementations
              that run all services with root privilege. The second form is use&#8208;
              ful for services that need special group privileges only.

DIAGNOSTICS
       When a syntax error is found in an access  control  rule,  the  error  is
       reported  to the syslog daemon; further options will be ignored, and ser&#8208;
       vice is denied.

SEE ALSO
       hosts_access(5), the default access control language

AUTHOR
       Wietse Venema (wietse@wzv.win.tue.nl)
       Department of Mathematics and Computing Science
       Eindhoven University of Technology
       Den Dolech 2, P.O. Box 513,
       5600 MB Eindhoven, The Netherlands




                                                                HOSTS_OPTIONS(5)

</pre></body></html>
