<html>
<head><meta charset=utf-8/>
<title>math::fuzzy - Fuzzy comparison of floating-point numbers</title></head>
<body><pre>

math::fuzzy(3tcl)               Tcl Math Library               math::fuzzy(3tcl)



________________________________________________________________________________

NAME
       math::fuzzy - Fuzzy comparison of floating-point numbers

SYNOPSIS
       package require Tcl  ?8.3?

       package require math::fuzzy  ?0.2?

       ::math::fuzzy::teq value1 value2

       ::math::fuzzy::tne value1 value2

       ::math::fuzzy::tge value1 value2

       ::math::fuzzy::tle value1 value2

       ::math::fuzzy::tlt value1 value2

       ::math::fuzzy::tgt value1 value2

       ::math::fuzzy::tfloor value

       ::math::fuzzy::tceil value

       ::math::fuzzy::tround value

       ::math::fuzzy::troundn value ndigits

_________________________________________________________________

DESCRIPTION
       The  package  Fuzzy is meant to solve common problems with floating-point
       numbers in a systematic way:

       &#183;      Comparing two numbers that are &quot;supposed&quot; to  be  identical,  like
              1.0  and  2.1/(1.2+0.9)  is  not  guaranteed to give the intuitive
              result.

       &#183;      Rounding a number that is halfway two integer  numbers  can  cause
              strange errors, like int(100.0*2.8) != 28 but 27

       The  Fuzzy  package is meant to help sorting out this type of problems by
       defining &quot;fuzzy&quot; comparison procedures for  floating-point  numbers.   It
       does so by allowing for a small margin that is determined automatically -
       the margin is three times the &quot;epsilon&quot; value, that is  three  times  the
       smallest  number  eps  such that 1.0 and 1.0+$eps canbe distinguished. In
       Tcl, which uses double precision floating-point numbers,  this  is  typi&#8208;
       cally 1.1e-16.

PROCEDURES
       Effectively the package provides the following procedures:

       ::math::fuzzy::teq value1 value2
              Compares  two floating-point numbers and returns 1 if their values
              fall within a small range. Otherwise it returns 0.

       ::math::fuzzy::tne value1 value2
              Returns the negation, that is, if the difference  is  larger  than
              the margin, it returns 1.
&#12;       ::math::fuzzy::tge value1 value2
              Compares  two floating-point numbers and returns 1 if their values
              either fall within a small range or if the first number is  larger
              than the second. Otherwise it returns 0.

       ::math::fuzzy::tle value1 value2
              Returns  1  if  the two numbers are equal according to [teq] or if
              the first is smaller than the second.

       ::math::fuzzy::tlt value1 value2
              Returns the opposite of [tge].

       ::math::fuzzy::tgt value1 value2
              Returns the opposite of [tle].

       ::math::fuzzy::tfloor value
              Returns the integer number that is lower or  equal  to  the  given
              floating-point number, within a well-defined tolerance.

       ::math::fuzzy::tceil value
              Returns  the  integer number that is greater or equal to the given
              floating-point number, within a well-defined tolerance.

       ::math::fuzzy::tround value
              Rounds the floating-point number off.

       ::math::fuzzy::troundn value ndigits
              Rounds the floating-point number off to the  specified  number  of
              decimals (Pro memorie).

       Usage:


              if { [teq $x $y] } { puts &quot;x == y&quot; }
              if { [tne $x $y] } { puts &quot;x != y&quot; }
              if { [tge $x $y] } { puts &quot;x &gt;= y&quot; }
              if { [tgt $x $y] } { puts &quot;x &gt; y&quot; }
              if { [tlt $x $y] } { puts &quot;x &lt; y&quot; }
              if { [tle $x $y] } { puts &quot;x &lt;= y&quot; }

              set fx      [tfloor $x]
              set fc      [tceil  $x]
              set rounded [tround $x]
              set roundn  [troundn $x $nodigits]


TEST CASES
       The  problems  that can occur with floating-point numbers are illustrated
       by the test cases in the file &quot;fuzzy.test&quot;:

       &#183;      Several test case use the  ordinary  comparisons,  and  they  fail
              invariably to produce understandable results

       &#183;      One test case uses [expr] without braces ({ and }). It too fails.

       The  conclusion  from this is that any expression should be surrounded by
       braces, because otherwise very awkward things  can  happen  if  you  need
       accuracy.  Furthermore,  accuracy and understandable results are enhanced
       by using these &quot;tolerant&quot; or fuzzy comparisons.

       Note that besides the Tcl-only package, there is also a C-based version.

REFERENCES
       Original implementation in Fortran by dr. H.D. Knoble (Penn State Univer&#8208;
       sity).
&#12;       P.  E.  Hagerty,  &quot;More  on  Fuzzy  Floor  and  Ceiling,&quot;  APL QUOTE QUAD
       8(4):20-24, June 1978. Note that TFLOOR=FL5 took five years  of  refereed
       evolution (publication).

       L.  M.  Breed,  &quot;Definitions for Fuzzy Floor and Ceiling&quot;, APL QUOTE QUAD
       8(3):16-23, March 1978.

       D. Knuth, Art of Computer Programming, Vol. 1, Problem 1.2.4-5.

BUGS, IDEAS, FEEDBACK
       This document, and the package it  describes,  will  undoubtedly  contain
       bugs  and  other  problems.   Please  report such in the category math ::
       fuzzy     of     the     Tcllib     SF      Trackers      [http://source&#8208;
       forge.net/tracker/?group_id=12883].   Please  also  report  any ideas for
       enhancements you may have for either package and/or documentation.

KEYWORDS
       floating-point, math, rounding

CATEGORY
       Mathematics



math                                   0.2                     math::fuzzy(3tcl)

</pre></body></html>
