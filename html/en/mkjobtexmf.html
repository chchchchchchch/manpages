<html>
<head><meta charset=utf-8/>
<title>mkjobtexmf -- Generate a texmf tree for a particular job</title></head>
<body><pre>

MKJOBTEXMF(1)          User Contributed Perl Documentation         MKJOBTEXMF(1)



NAME
       mkjobtexmf -- Generate a texmf tree for a particular job

VERSION
       2011-11-10 v0.8

SYNOPSIS
       The progam mkjobtexmf runs a program and tries to find the used file
       names. Two methods are available, option &quot;-recorder&quot; of TeX (Web2C) or
       the program strace.

       Then it generates a directory with a texmf tree. It checks the found
       files and tries sort them in this texmf tree.

       It can be used for archiving purposes or to speed up following TeX runs.

           mkjobtexmf [options]

       This runs TeX that can be configured by options.  Both methods for get&#8208;
       ting the used file names are available.

           mkjobtexmf [options] -- &lt;cmd&gt; [args]

       The latter form runs program cmd with arguments args instead of TeX. As
       method only program strace is available.

       Options:

           --jobname &lt;name&gt;       Name of the job (mandatory).
                                     Usually this is the TeX file
                                     without extension
           --texname &lt;file&gt;       Input file for TeX. Default is the
                                     job name with extension &apos;.tex&apos;
           --texopt &lt;option&gt;      Option for TeX run
           --destdir &lt;directory&gt;  Destination directory,
                                     default is `&lt;jobname&gt;.mjt&apos;
           --output               Add also output files
           --strace               Use strace instead of TeX&apos;s
                                     option -recorder
           --copy                 Copy files instead of creating
                                     symbol links
           --flat                 Junk paths, do not make directories
                                     inside the destination directory
           --(no)texhash          Run texhash, use --notexhash for MiKTeX
           --exclude-ext &lt;ext&gt;    Exclude files with extension &lt;ext&gt;.
           --cmd-tex &lt;cmd&gt;        Command for the TeX compiler
           --cmd-kpsewhich &lt;cmd&gt;  Command for kpsewhich
           --cmd-texhash &lt;cmd&gt;    Command for texhash
           --cmd-strace &lt;cmd&gt;     Command for strace
           --verbose              Verbose output
           --help                 Brief help message
           --man                  Full documentation
           --version              Print version identification

DESCRIPTION
       Running the program

       First mkjobtexmf runs a program, usually TeX. The TeX compiler is config&#8208;
       ured by option &quot;--cmd-tex&quot;. Option &quot;--texname&quot; can be used, if the file
       name extension differs from .tex:

           mkjobtexmf --jobname foo --texname foo.ltx
&#12;       Even more complicate cases are possible:

           mkjobtexmf --jobname foo --texname &apos;\def\abc{...}\input{foo}&apos;

       If another program than TeX should be used (dvips, ...), then this pro&#8208;
       gram can be given after &quot;--&quot;:

           mkjobtexmf --jobname foo -- dvips foo

       File recording

       Two methods are available to get the used file names:

       Recorder of TeX
           Some TeX distributions (e.g. Web2C) support the option -recorder for
           its TeX compilers. Then the TeX compiler generates a file with exten&#8208;
           sion .fls that records the used input and output files.

       Program strace
           This program traces system calls and signals. It is used here to log
           the used files.

       Analyze and link/copy found files

       The result directory jobname.mjt is generated. Inside the result TEXMF
       tree is created. Each found file is compared against a list of paths of
       TEXMF trees. If a match is found, the file is linked/copied into the
       TEXMF tree. The list of paths is generated by program kpsewhich.

       If the file cannot be mapped to a TEXMF tree and the file is a relative
       file name, then it is directly linked/copied into the result directory
       jobname.mjt. Absolute file names are not supported and neither paths with
       links to parent directories.

       Symbolic links are created by default. The files are copied if option
       &quot;--copy&quot; is given or symbolic linking is not available.

OPTIONS
       --jobname=&lt;jobname&gt;
           It is the name of the job. `&lt;jobname&gt;.tex&apos; serves as default for the
           TeX file and &lt;jobname&gt; is used for naming various directories and
           files. See section &quot;FILES&quot;.

       --texname=&lt;name&gt;
           The name of the TeX input file, if it differs from &lt;jobname&gt;.tex.

       --texopt=&lt;opt&gt;
           Additional option for the TeX compiler, examples are &quot;--ini&quot; or
           &quot;--shell-escape&quot;. This option can be given more than once.

       --destdir=&lt;directory&gt;
           Specifies the name of the destination directory where the result is
           collected. As default a directory is generated in the current direc&#8208;
           tory with the job name and extension `.mjt&apos;.

       --output
           Also add output files.

       --strace
           Use method with program strace, see &quot;DESCRIPTION&quot;.

       --copy
           Files are copied instead of creating symbolic links.

       --flat
           Files are linked or copied without path elements.  The destination
           directory will contain a flat list of files or links without direc&#8208;
           tory.

           The files `ls-R&apos; and `aliases&apos; are ignored.

       --exclude-ext=&lt;ext&gt;
           Files with extension &lt;ext&gt; are excluded. The option can be given sev&#8208;
           eral times or a comma separated list of extensions can be used. Exam&#8208;
           ples:

               --exclude-ext aux --exclude-ext log --exclude-ext toc

           is the same as

               --exclude-ext aux,log,toc

       --(no)texhash
           As default the file `ls-R&apos; is generated in the `texmf&apos; tree, because
           this is the file name database that might be used in TeX Live.
           Because MiKTeX uses a different mechanism, its `texhash&apos; does not
           generate the `ls-R&apos; files and &quot;--notexhash&quot; suppresses the call of
           `texhash&apos;.

       --cmd-tex=&lt;cmd&gt;
           Command for the TeX compiler. Default is pdflatex.

       --cmd-kpsewhich=&lt;cmd&gt;
           Command for kpsewhich.

       --cmd-texhash=&lt;cmd&gt;
           Command for updating the file name database of the generated texmf
           tree. Default is texmf.

       --cmd-strace=&lt;cmd&gt;
           Command for strace.

       --verbose
           Verbose messages.

       --help
           Display help screen.

       -B(-man&gt;
           Print manual page.

       --version
           Print version identification and exit.

EXAMPLES
       TeX file test.tex using TeX&apos;s recorder method:

           mkjobtexmf --jobname test

       TeX file test.tex using LaTeX:

           mkjobtexmf --jobname test --cmd-tex latex

       Format generation:

           mkjobtexmf --jobname test --texopt -ini --texname pdflatex.ini

       Example, how the new texmf tree (Linux/bash) can be used:

           TEXMF=!!test.mjt/texmf pdflatex test

       Example for generating a zip archive (Linux/bash):

           (cd test.mjt &amp;&amp; zip -9r ../test .)
&#12;       Example for generating a tar archive:

           tar cjhvf test.tar.bz2 -C test.mjt .

UNSOLVED ISSUES, CAVEATS, TODOS
       Experimental software
           Options, defaults, how the program works might change in future ver&#8208;
           sions.

       texmf.cnf
           Currently the method with strace records this files.  TeX&apos;s recorder
           does not. Useful are texmf.cnf files for variable settings. Because
           we have just one TEXMF tree, the path sections should probably
           rewritten.

       Settings in environment variables
           They are not stored at all.

       Collisions
           The program uses one destination directory and at most one TEXMF tree
           for the result. However, the source files can come from different
           directories and TEXMF trees.  Therefore name collisions are possible.

           The program follows the strategy not to delete files in the destina&#8208;
           tion directory. That allows to collect files from differnt runs. Thus
           collisions are resolved in the manner that the first entry that is
           made in the destination directory wins.

       Configuration file
           It would save the user from retyping the same options again and
           again.

       Uncomplete recording
           Bugs in TeX&apos;s file recording might result in incomplete file record&#8208;
           ing (e.g. pdfTeX 1.40.3 does not record .pfb and .pk files).

       ...

FILES
       &lt;jobname&gt;.mjt/
           Directory where the resulting texmf tree and symbol links are stored.
           It can be changed by option &quot;--destdir&quot;.

       &lt;jobname&gt;.fls
           Name of TeX&apos;s recorder file.

       &lt;jobname&gt;.strace
           Log file where the result of strace is stored.

AUTHOR
       Heiko Oberdiek, email: heiko.oberdiek at googlemail.com

COPYRIGHT AND LICENSE
       Copyright 2007, 2008, 2011 by Heiko Oberdiek.

       This library is free software; you may redistribute it and/or modify it
       under the same terms as Perl itself (Perl Artistic License/GNU General
       Public License, version 2).

HISTORY
       2007/04/16 v0.1
         * First experimental version.
       2007/05/09 v0.2
         * Typo in option name fixed.
       2007/09/03 v0.3
         * New options: &quot;--copy&quot;, &quot;--flat&quot;, &quot;--destdir&quot;
       2007/09/04 v0.4
         * Bug fix in map_files_texmf.
       2007/09/06 v0.5
         * Support for `configure&apos; added. (Thanks to Norbert Preining for writ&#8208;
         ing a first version of the configure stuff.)
       2008/04/05 v0.6
         * Tiny fix in target `uninstall&apos; in file `Makefile.in&apos;. (Thanks to Karl
         Berry)
       2008/06/28 v0.7
         * Fix for unknown option `&quot;--cmd-strace&quot;&apos;. (Thanks to Juho Niemel&#228;)
       2011/11/10 v0.8
         * Remove colon from drive specification when making directories.
         * Option &quot;--(no)texhash&quot; added.
         * Some support for MiKTeX (thanks Ulrike Fischer).
         * Various fixes in the generation of the documentation.
         * Options &quot;--exclude-ext&quot; and &quot;--version&quot; added.



perl v5.8.1                      2011-11-10 v0.8                   MKJOBTEXMF(1)

</pre></body></html>
