<html>
<head><meta charset=utf-8/>
<title>pthread_getcpuclockid - retrieve ID of a thread's CPU time clock</title></head>
<body><pre>

PTHREAD_GETCPUCLOCKID(3)    Linux Programmer&apos;s Manual   PTHREAD_GETCPUCLOCKID(3)



NAME
       pthread_getcpuclockid - retrieve ID of a thread&apos;s CPU time clock

SYNOPSIS
       #include &lt;pthread.h&gt;
       #include &lt;time.h&gt;

       int pthread_getcpuclockid(pthread_t thread, clockid_t *clock_id);

       Compile and link with -pthread.

DESCRIPTION
       The  pthread_getcpuclockid()  function  returns  the clock ID for the CPU
       time clock of the thread thread.

RETURN VALUE
       On success, this function returns 0; on error, it returns a nonzero error
       number.

ERRORS
       ENOENT Per-thread CPU time clocks are not supported by the system.

       ESRCH  No thread with the ID thread could be found.

VERSIONS
       This function is available in glibc since version 2.2.

CONFORMING TO
       POSIX.1-2001.

NOTES
       When  thread refers to the calling thread, this function returns an iden&#8208;
       tifier that refers to the same clock manipulated by clock_gettime(2)  and
       clock_settime(2) when given the clock ID CLOCK_THREAD_CPUTIME_ID.

EXAMPLE
       The  program  below  creates  a  thread and then uses clock_gettime(2) to
       retrieve the total process CPU time, and the per-thread CPU time consumed
       by the two threads.  The following shell session shows an example run:
           $ ./a.out
           Main thread sleeping
           Subthread starting infinite loop
           Main thread consuming some CPU time...
           Process total CPU time:    1.368
           Main thread CPU time:      0.376
           Subthread CPU time:        0.992

   Program source

       /* Link with &quot;-lrt&quot; */

       #include &lt;time.h&gt;
       #include &lt;stdio.h&gt;
       #include &lt;stdlib.h&gt;
       #include &lt;unistd.h&gt;
       #include &lt;pthread.h&gt;
       #include &lt;string.h&gt;
       #include &lt;errno.h&gt;

       #define handle_error(msg) \
               do { perror(msg); exit(EXIT_FAILURE); } while (0)
&#12;       #define handle_error_en(en, msg) \
               do { errno = en; perror(msg); exit(EXIT_FAILURE); } while (0)

       static void *
       thread_start(void *arg)
       {
           printf(&quot;Subthread starting infinite loop\n&quot;);
           for (;;)
               continue;
       }

       static void
       pclock(char *msg, clockid_t cid)
       {
           struct timespec ts;

           printf(&quot;%s&quot;, msg);
           if (clock_gettime(cid, &amp;ts) == -1)
               handle_error(&quot;clock_gettime&quot;);
           printf(&quot;%4ld.%03ld\n&quot;, ts.tv_sec, ts.tv_nsec / 1000000);
       }

       int
       main(int argc, char *argv[])
       {
           pthread_t thread;
           clockid_t cid;
           int j, s;

           s = pthread_create(&amp;thread, NULL, thread_start, NULL);
           if (s != 0)
               handle_error_en(s, &quot;pthread_create&quot;);

           printf(&quot;Main thread sleeping\n&quot;);
           sleep(1);

           printf(&quot;Main thread consuming some CPU time...\n&quot;);
           for (j = 0; j &lt; 2000000; j++)
               getppid();

           pclock(&quot;Process total CPU time: &quot;, CLOCK_PROCESS_CPUTIME_ID);

           s = pthread_getcpuclockid(pthread_self(), &amp;cid);
           if (s != 0)
               handle_error_en(s, &quot;pthread_getcpuclockid&quot;);
           pclock(&quot;Main thread CPU time:   &quot;, cid);

           /* The preceding 4 lines of code could have been replaced by:
              pclock(&quot;Main thread CPU time:   &quot;, CLOCK_THREAD_CPUTIME_ID); */

           s = pthread_getcpuclockid(thread, &amp;cid);
           if (s != 0)
               handle_error_en(s, &quot;pthread_getcpuclockid&quot;);
           pclock(&quot;Subthread CPU time: 1    &quot;, cid);

           exit(EXIT_SUCCESS);         /* Terminates both threads */
       }

SEE ALSO
       clock_gettime(2),    clock_settime(2),   timer_create(2),   clock_getcpu&#8208;
       clockid(3), pthread_self(3), pthreads(7), time(7)

COLOPHON
       This page is part of release 3.44 of  the  Linux  man-pages  project.   A
       description  of the project, and information about reporting bugs, can be
       found at http://www.kernel.org/doc/man-pages/.



Linux                              2009-02-08           PTHREAD_GETCPUCLOCKID(3)

</pre></body></html>
